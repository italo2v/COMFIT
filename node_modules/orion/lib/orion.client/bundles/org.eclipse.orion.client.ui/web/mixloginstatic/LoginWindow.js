define("domReady",[],function(){function e(e){var t;for(t=0;t<e.length;t+=1)e[t](c)}function t(){var t=l;u&&t.length&&(l=[],e(t))}function n(){u||(u=!0,s&&clearInterval(s),t())}function r(e){return u?e(c):l.push(e),r}var o,i,s,a="undefined"!=typeof window&&window.document,u=!a,c=a?document:null,l=[];if(a){if(document.addEventListener)document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1);else if(window.attachEvent){window.attachEvent("onload",n),i=document.createElement("div");try{o=null===window.frameElement}catch(d){}i.doScroll&&o&&window.external&&(s=setInterval(function(){try{i.doScroll(),n()}catch(e){}},30))}"complete"===document.readyState&&n()}return r.version="2.0.1",r.load=function(e,t,n,o){o.isBuild?n(null):r(n)},r}),function(e,t){"function"==typeof define&&define.amd?define("orion/Deferred",t):"object"==typeof exports?module.exports=t():(e.orion=e.orion||{},e.orion.Deferred=t())}(this,function(){function e(){for(var e;e=i.shift();)e();s=!1}function t(e){i.push(e),s||(s=!0,a())}function n(e){return function(t){e(t)}}function r(e,t,r){try{var o=e(t),i=o&&("object"==typeof o||"function"==typeof o)&&o.then;if("function"==typeof i)if(o===r.promise)r.reject(new TypeError);else{var s=o.cancel;"function"==typeof s?r._parentCancel=s.bind(o):delete r._parentCancel,i.call(o,n(r.resolve),n(r.reject),n(r.progress))}else r.resolve(o)}catch(a){r.reject(a)}}function o(){function e(){for(var e;e=c.shift();){var t=e.deferred,n="fulfilled"===u?"resolve":"reject",o=e[n];"function"==typeof o?r(o,a,t):t[n](a)}}function n(n){delete l._parentCancel,u="rejected",a=n,c.length&&t(e)}function i(r){function s(e){return function(t){u&&"assumed"!==u||e(t)}}delete l._parentCancel;try{var d=r&&("object"==typeof r||"function"==typeof r)&&r.then;if("function"==typeof d)if(r===l)n(new TypeError);else{u="assumed";var f=r&&r.cancel;if("function"!=typeof f){var m=new o;r=m.promise;try{d(m.resolve,m.reject,m.progress)}catch(p){m.reject(p)}f=r.cancel,d=r.then}a=r,d.call(r,s(i),s(n)),l._parentCancel=f.bind(r)}else u="fulfilled",a=r,c.length&&t(e)}catch(h){s(n)(h)}}function s(){var e=l._parentCancel;if(e)delete l._parentCancel,e();else if(!u){var t=new Error("Cancel");t.name="Cancel",n(t)}}var a,u,c=[],l=this;this.resolve=function(e){return u||i(e),l},this.reject=function(e){return u||n(e),l},this.progress=function(e){return u||c.forEach(function(t){if(t.progress)try{t.progress(e)}catch(n){}}),l.promise},this.cancel=function(){return l._parentCancel?setTimeout(s,0):s(),l},this.then=function(n,r,i){var s=new o;return s._parentCancel=l.promise.cancel,c.push({resolve:n,reject:r,progress:i,deferred:s}),("fulfilled"===u||"rejected"===u)&&t(e),s.promise},this.promise={then:l.then,cancel:l.cancel}}var i=[],s=!1,a=function(){if("undefined"!=typeof process&&"function"==typeof process.nextTick){var t=process.nextTick;return function(){t(e)}}if("function"==typeof MutationObserver){var n=document.createElement("div"),r=new MutationObserver(e);return r.observe(n,{attributes:!0}),function(){n.setAttribute("class","_tick")}}return function(){setTimeout(e,0)}}();return o.all=function(e,t){function n(e,t){a||(s[e]=t,0===--i&&u.resolve(s))}function r(e,r){if(!a){if(t)try{return void n(e,t(r))}catch(o){r=o}u.reject(r)}}var i=e.length,s=[],a=!1,u=new o;return u.then(void 0,function(){a=!0,e.forEach(function(e){e.cancel&&e.cancel()})}),0===i?u.resolve(s):e.forEach(function(e,t){e.then(n.bind(void 0,t),r.bind(void 0,t))}),u.promise},o.when=function(e,t,n,r){var i,s;return e&&"function"==typeof e.then?i=e:(s=new o,s.resolve(e),i=s.promise),i.then(t,n,r)},o}),define("orion/xsrfUtils",[],function(){function e(){var e,t,n,o=document.cookie.split(";");for(e=0;e<o.length;e++)if(t=o[e].substr(0,o[e].indexOf("=")).trim(),n=o[e].substr(o[e].indexOf("=")+1).trim(),t==r)return n}function t(t){var n=e();n&&(t[r]=n)}function n(t){var n=e();n&&t.setRequestHeader(r,n)}var r="x-csrf-token";return{XSRF_TOKEN:r,getCSRFToken:e,setNonceHeader:t,addCSRFNonce:n}}),function(){function e(e){if("string"!=typeof e)throw new TypeError}function t(e){return e?e.split("&"):[]}function n(e){return 0===e.length?"":e.join("&")}function r(e){var t=/([^=]*)(?:=?)(.*)/.exec(e),n=t[1]?decodeURIComponent(t[1]):"",r=t[2]?decodeURIComponent(t[2]):"";return[n,r]}function o(e){var t=encodeURIComponent(e[0]);return e[1]&&(t+="="+encodeURIComponent(e[1])),t}function i(e,n){var o="",i=[],s=0;return{next:function(){if(o!==e.query&&(o=e.query,i=t(o)),s<i.length){var a=r(i[s++]);switch(n){case"keys":return a[0];case"values":return a[1];case"keys+values":return[a[0],a[1]];default:throw new TypeError}}throw U}}}function s(e){Object.defineProperty(this,"_url",{get:function(){return e._url}})}function a(e,t){if(!e.scheme&&t&&(e.scheme=t.scheme,!e.host&&t.host&&(e.userinfo=t.userinfo,e.host=t.host,e.port=t.port,e.pathRelative=!0)),e.pathRelative)if(e.path){if("/"!==e.path[0]){var n=/^(.*\/)[^\/]*$/.exec(t.path)[1]||"/";e.path=n+e.path}}else e.path=t.path}function u(e){return e.toLowerCase()}function c(e){return e?/[1-9]\d*$/.exec(e)[0]:""}function l(e){var t=[];return e.split("/").forEach(function(e){".."===e?t.pop():"."!==e&&t.push(e)}),t.join("/")}function d(e){e.scheme&&(e.scheme=u(e.scheme)),e.port&&(e.port=c(e.port)),e.host&&e.path&&(e.path=l(e.path))}function f(e){return e.replace(/\s/g,function(e){return"%"+e.charCodeAt(0).toString(16)})}function m(e,t){if("string"!=typeof e)throw new TypeError;e=f(e);var n=v.exec(e);if(!n)return null;var r={};if(r.scheme=n[1]||"",r.scheme&&!b.test(r.scheme))return null;var o=n[2];if(o){var i=E.exec(o);if(r.userinfo=i[1],r.host=i[2],r.port=i[3],r.port&&!I.test(r.port))return null}return r.path=n[3],r.query=n[4],r.fragment=n[5],a(r,t),d(r),r}function p(e){var t=e.scheme?e.scheme+":":"";return e.host&&(t+="//",e.userinfo&&(t+=e.userinfo+"@"),t+=e.host,e.port&&(t+=":"+e.port)),t+=e.path,e.query&&(t+="?"+e.query),e.fragment&&(t+="#"+e.fragment),t}function h(e,t){var n;if(t){if(t=t.href||t,n=m(t),!n||!n.scheme)throw new SyntaxError;Object.defineProperty(this,"_baseURL",{value:n})}var r=m(e,n);if(!r)throw new SyntaxError;Object.defineProperty(this,"_input",{value:e,writable:!0}),Object.defineProperty(this,"_url",{value:r,writable:!0});var o=new s(this);Object.defineProperty(this,"query",{get:function(){return this._url?o:null},enumerable:!0})}try{var y;if("function"==typeof window.URL&&0!==window.URL.length&&"http:"===(y=new window.URL("http://www.w3.org?q")).protocol&&y.query)return}catch(g){}var v=/^(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?$/,E=/^(?:(.*)@)?(\[[^\]]*\]|[^:]*)(?::(.*))?$/,w=/^\S*$/,b=/^([a-zA-Z](?:[a-zA-Z0-9+-.])*)$/,I=/^\d*$/,_=/^(\[[^\]\/?#\s]*\]|[^:\/?#\s]*)$/,R=/^(\[[^\]\/?#\s]*\]|[^:\/?#\s]*)(?::(\d*))?$/,x=/^([^?#\s]*)$/,C=/^([^\s]*)$/,B=w,L=/([^:]*):?(.*)/,U="undefined"!=typeof StopIteration?StopIteration:new Error("Stop Iteration"),S={"ftp:":"21","gopher:":"70","http:":"80","https:":"443","ws:":"80","wss:":"443"};Object.defineProperties(s.prototype,{get:{value:function(n){e(n);var o,i=t(this._url.query);return i.some(function(e){var t=r(e);return t[0]===n?(o=t[1],!0):void 0}),o},enumerable:!0},set:{value:function(i,s){e(i),e(s);var a=t(this._url.query),u=a.some(function(e,t){var n=r(e);return n[0]===i?(n[1]=s,a[t]=o(n),!0):void 0});u||a.push(o([i,s])),this._url.query=n(a)},enumerable:!0},has:{value:function(n){e(n);var o=t(this._url.query);return o.some(function(e){var t=r(e);return t[0]===n?!0:void 0})},enumerable:!0},"delete":{value:function(o){e(o);var i=t(this._url.query),s=i.filter(function(e){var t=r(e);return t[0]!==o});return s.length!==i.length?(this._url.query=n(s),!0):!1},enumerable:!0},clear:{value:function(){this._url.query=""},enumerable:!0},forEach:{value:function(e,t){if("function"!=typeof e)throw new TypeError;var n=i(this._url,"keys+values");try{for(;;){var r=n.next();e.call(t,r[1],r[0],this)}}catch(o){if(o!==U)throw o}},enumerable:!0},keys:{value:function(){return i(this._url,"keys")},enumerable:!0},values:{value:function(){return i(this._url,"values")},enumerable:!0},items:{value:function(){return i(this._url,"keys+values")}},size:{get:function(){return t(this._url.query).length},enumerable:!0},getAll:{value:function(n){e(n);var o=[],i=t(this._url.query);return i.forEach(function(e){var t=r(e);t[0]===n&&o.push(t[1])}),o},enumerable:!0},append:{value:function(r,i){e(r),e(i);var s=t(this._url.query);s.push(o([r,i])),this._url.query=n(s)},enumerable:!0}}),Object.defineProperties(h.prototype,{href:{get:function(){return this._url?p(this._url):this._input},set:function(t){e(t),this._input=t,this._url=m(this._input,this._baseURL)},enumerable:!0},origin:{get:function(){return this._url&&this._url.host?this.protocol+"//"+this.host:""},enumerable:!0},protocol:{get:function(){return this._url?this._url.scheme+":":":"},set:function(t){if(e(t),this._url){var n=":"===t.slice(-1)?t.substring(0,t.length-1):t;(""===n||b.test(n))&&(this._url.scheme=u(n))}},enumerable:!0},_userinfo:{get:function(){return this._url?this._url.userinfo:""},set:function(t){e(t),this._url&&(this._url.userinfo=t)}},username:{get:function(){if(!this._url)return"";var e=L.exec(this._userinfo),t=decodeURIComponent(e[1]||"");return t},set:function(t){if(e(t),this._url){var n=L.exec(this._userinfo),r=[encodeURIComponent(t||"")];n[2]&&r.push(n[2]),this._userinfo=r.join(":")}},enumerable:!0},password:{get:function(){if(!this._url)return"";var e=L.exec(this._userinfo),t=decodeURIComponent(e[2]||"");return t},set:function(t){if(e(t),this._url){var n=L.exec(this._userinfo),r=[n[1]||""];t&&r.push(encodeURIComponent(t)),this._userinfo=r.join(":")}},enumerable:!0},host:{get:function(){var e="";return this._url&&this._url.host&&(e+=this._url.host,this._url.port&&(e+=":"+this._url.port)),e},set:function(t){if(e(t),this._url){var n=R.exec(t);n&&(this._url.host=n[1],this._url.port=c(n[2]))}},enumerable:!0},hostname:{get:function(){return this._url?this._url.host:""},set:function(t){if(e(t),this._url){var n=_.exec(t);n&&(this._url.host=t)}},enumerable:!0},port:{get:function(){var e=this._url?this._url.port||"":"";return e&&e===S[this.protocol]&&(e=""),e},set:function(t){if(e(t),this._url){var n=I.exec(t);n&&(this._url.port=c(t))}},enumerable:!0},pathname:{get:function(){return this._url?this._url.path:""},set:function(t){if(e(t),this._url){var n=x.exec(t);n&&(this._url.host&&t&&"/"!==t[0]&&(t="/"+t),this._url.path=t?l(t):"")}},enumerable:!0},search:{get:function(){return this._url&&this._url.query?"?"+this._url.query:""},set:function(t){if(e(t),this._url){t&&"?"===t[0]&&(t=t.substring(1));var n=C.exec(t);n&&(this._url.query=t)}},enumerable:!0},hash:{get:function(){return this._url&&this._url.fragment?"#"+this._url.fragment:""},set:function(t){if(e(t),this._url){t&&"#"===t[0]&&(t=t.substring(1));var n=B.exec(t);n&&(this._url.fragment=t)}},enumerable:!0}});var O=window.URL||window.webkitURL;O&&O.createObjectURL&&(Object.defineProperty(h,"createObjectURL",{value:O.createObjectURL.bind(O),enumerable:!1}),Object.defineProperty(h,"revokeObjectURL",{value:O.revokeObjectURL.bind(O),enumerable:!1})),window.URL=h}(),define("orion/URL-shim",function(){}),define("orion/xhr",["orion/Deferred","orion/xsrfUtils","orion/URL-shim"],function(e,t){function n(e,t,n,r){var o,i="undefined"!=typeof n.response?n.response:n.responseText,s="string"==typeof i?i:null;try{o=n.status}catch(a){o=0}var u={args:t,response:i,responseText:s,status:o,url:e,xhr:n};return"undefined"!=typeof r&&(u.error=r),u}function r(e){return new URL(location.href).origin===new URL(e,location.href).origin}function o(o,i,s){s=s||{};var a=arguments.length>3&&arguments[3]?arguments[3]:new XMLHttpRequest,u=new e,c=s.headers||{};r(i)&&t.setNonceHeader(c);var l,d=s.log||!1;"undefined"==typeof c["X-Requested-With"]&&(c["X-Requested-With"]="XMLHttpRequest"),"undefined"==typeof s.data||"POST"!==o&&"PUT"!==o||(l=s.data);var f=!1,m=!1;u.promise.then(void 0,function(e){f=!0,!m&&e instanceof Error&&"Cancel"===e.name&&a.abort()}),a.onabort=function(){if(m=!0,!f){var e=new Error("Cancel");e.name="Cancel",u.reject(e)}},a.onload=function(){var e=n(i,s,a);200<=a.status&&a.status<400?u.resolve(e):(u.reject(e),d&&"undefined"!=typeof console&&console.log(new Error(a.statusText)))},a.onerror=function(){var e=n(i,s,a);u.reject(e),d&&"undefined"!=typeof console&&console.log(new Error(a.statusText))},a.onprogress=function(e){e.xhr=a,u.progress(e)};try{if(a.open(o,i,!0),"string"==typeof s.responseType&&(a.responseType=s.responseType),"number"==typeof s.timeout)if("number"==typeof a.timeout)a.timeout=s.timeout,a.addEventListener("timeout",function(){u.reject(n(i,s,a,"Timeout exceeded"))});else{var p=setTimeout(function(){u.reject(n(i,s,a,"Timeout exceeded"))},s.timeout);u.promise.then(clearTimeout.bind(null,p),clearTimeout.bind(null,p))}Object.keys(c).forEach(function(e){a.setRequestHeader(e,c[e])}),a.send(l||null)}catch(h){u.reject(n(i,s,a,h))}return u.promise}return o}),define("orion/PageUtil",[],function(){function e(){var e=window.location.href.split("#")[1];return e=e?"#"+e:""}function t(e){e=e||window.location.toString();var t={resource:""},n=e.indexOf("#");if(-1!==n){var r=e.substring(n+1);if(0!==r.length){var o=r.split(",");t.resource=decodeURIComponent(o[0]);for(var i=1;i<o.length;i++){var s=o[i],a=/([^=]*)(=?)(.*)/.exec(s),u=decodeURIComponent(a[1]||""),c=decodeURIComponent(a[3]||"");""!==u&&"resource"!==u&&(t[u]=c)}}}return t}function n(e,t){var n=e;if(-1===e.indexOf("://")){var o=document.createElement("a");o.href=e,n=o.href}var i=!1;return i=t?t.some(function(e){return new RegExp("^"+e+":","i").test(n)}):r.test(n),i?e:(console.log("Illegal URL Scheme: '"+e+"'"),"")}var r=new RegExp("^http[s]?","i");return{hash:e,matchResourceParameters:t,validateURLScheme:n}}),define("orion/URITemplate",[],function(){function e(e){this._text=e}function t(e){return e.replace("%25","%")}function n(e,n){if("U"===n)return encodeURIComponent(e).replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()});if("U+R"===n)return encodeURI(e).replace(/%5B/g,"[").replace(/%5D/g,"]").replace(d,t);if("U+R-,"===n)return encodeURI(e).replace(/%5B/g,"[").replace(/%5D/g,"]").replace(/,/g,"%2C");throw new Error("Unknown allowed character set: "+n)}function r(e,t,r){for(var o=[],i=0;i<e.length;i++)"undefined"!=typeof e[i]&&o.push(n(e[i],t));return o.join(r)}function o(e,t,r,o){for(var i=Object.keys(e),s=[],a=0;a<i.length;a++)"undefined"!=typeof e[i[a]]&&s.push(n(i[a],t)+r+n(e[i[a]],t));return s.join(o)}function i(e){for(var t=[],n=e.split(","),r=0;r<n.length;r++){var o=n[r].match(l);if(null===o)throw new Error("Bad VarSpec: "+e);t.push({name:o[1],explode:!!o[2],prefix:o[3]?parseInt(o[3],10):-1})}return t}function s(e){if(0===e.length)throw new Error("Invalid Expression: 0 length expression");this._operator=c[e[0]],this._operator?e=e.substring(1):this._operator=c.NUL,this._varSpecList=i(e)}function a(t){for(var n=[],r=0,o=t.indexOf("{",r);-1!==o;){n.push(new e(t.substring(r,o)));var i=t.indexOf("}",o+1);if(-1===i)throw new Error("Invalid template: "+t);n.push(new s(t.substring(o+1,i))),r=i+1,o=t.indexOf("{",r)}return n.push(new e(t.substring(r))),n}function u(e){this._templateComponents=a(e)}var c={NUL:{first:"",sep:",",named:!1,ifemp:"",allow:"U"},"+":{first:"",sep:",",named:!1,ifemp:"",allow:"U+R"},".":{first:".",sep:",",named:!1,ifemp:"",allow:"U"},"/":{first:"/",sep:"/",named:!1,ifemp:"",allow:"U"},";":{first:";",sep:";",named:!0,ifemp:"",allow:"U"},"?":{first:"?",sep:"&",named:!0,ifemp:"=",allow:"U"},"&":{first:"&",sep:"&",named:!0,ifemp:"=",allow:"U"},"#":{first:"#",sep:",",named:!1,ifemp:"",allow:"U+R"},",":{first:"",sep:",",named:!1,ifemp:"",allow:"U+R-,"}},l=/^((?:(?:[a-zA-Z0-9_])|(?:%[0-9A-F][0-9A-F]))(?:(?:[a-zA-Z0-9_.])|(?:%[0-9A-F][0-9A-F]))*)(?:(\*)|:([0-9]+))?$/,d=/%25[0-9A-F][0-9A-F]/g;return e.prototype={expand:function(){return encodeURI(this._text)}},s.prototype={expand:function(e){for(var t=[],i=0;i<this._varSpecList.length;i++){var s=this._varSpecList[i],a=s.name,u=e[a],c=typeof u;if("undefined"!==c&&null!==u){var l=0===t.length?this._operator.first:this._operator.sep;if("string"===c)this._operator.named&&(l+=n(a,"U+R"),l+=0===u.length?this._operator.ifemp:"="),-1!==s.prefix&&s.prefix<u.length&&(u=u.substring(0,s.prefix)),l+=n(u,this._operator.allow);else if(Array.isArray(u)){if(0===u.length)continue;if(s.explode)l+=r(u,this._operator.allow,this._operator.sep);else{var d=r(u,this._operator.allow,",");this._operator.named&&(l+=n(a,"U+R"),l+=0===d.length?this._operator.ifemp:"="),l+=d}}else{if("object"!==c)throw new Error("bad param type: "+a+" : "+c);if(0===Object.keys(u).length)continue;if(s.explode)l+=o(u,this._operator.allow,"=",this._operator.sep);else{var f=o(u,this._operator.allow,",",",");this._operator.named&&(l+=n(a,"U+R"),l+=0===f.length?this._operator.ifemp:"="),l+=f}}t.push(l)}}return t.join("")}},u.prototype={expand:function(e){for(var t=[],n=0;n<this._templateComponents.length;n++)t.push(this._templateComponents[n].expand(e));return t.join("")}},u}),define("orion/i18nUtil",["require","orion/Deferred"],function(){function e(e){var t=/\$\{([^\}]+)\}/g,n=arguments;return 2===n.length&&n[1]&&"object"==typeof n[1]?e.replace(t,function(e,t){return n[1][t]}):e.replace(t,function(e,t){return n[(t<<0)+1]})}return{formatMessage:e}}),define("orion/objects",[],function(){function e(e){for(var t=Object.prototype.hasOwnProperty,n=1,r=arguments.length;r>n;n++){var o=arguments[n];for(var i in o)t.call(o,i)&&(e[i]=o[i])}return e}return{clone:function(t){if(Array.isArray(t))return Array.prototype.slice.call(t);var n=Object.create(Object.getPrototypeOf(t));return e(n,t),n},mixin:e,toArray:function(e){return Array.isArray(e)?e:[e]}}}),define("orion/PageLinks",["require","orion/Deferred","orion/PageUtil","orion/URITemplate","orion/i18nUtil","orion/objects","orion/URL-shim"],function(e,t,n,r,o,i){function s(){if(e.toUrl){var t=new URL(e.toUrl("orion/"),window.location.href);return new URL("../",t).href.slice(0,-1)}return new URL("/",window.location.href).href.slice(0,-1)}function a(e,t){return c(e,t).then(function(e){return new f(e)})}function u(e){var t={};return e.getPropertyKeys().forEach(function(n){"objectClass"!==n&&"service.names"!==n&&"service.id"!==n&&"__plugin__"!==n&&(t[n]=e.getProperty(n))}),t}function c(e,o){o=o||"orion.page.link";var i=e.getServiceReferences(o),a=n.matchResourceParameters(window.location.href),c=s(),l={OrionHome:c,Location:a.resource},d=[];return i.forEach(function(e){var o=u(e);if(o.uriTemplate&&(o.nls||o.name)){var i=new r(o.uriTemplate),s=i.expand(l);s=n.validateURLScheme(s),o.href=s,o.textContent=o.name||o.nameKey,d.push((new t).resolve(o))}}),t.all(d)}function l(e){var n;if(!h){n=[];var r=e.getServiceReferences("orion.page.link.category");return r.forEach(function(r){var o=u(r);o.id&&(o.name||o.nameKey)&&(o.service=e.getService(r),o.textContent=o.name,n.push((new t).resolve(o)))}),t.all(n).then(function(e){return h=new d(e)})}return(new t).resolve(h)}function d(e){var t=this.categories=Object.create(null);e.forEach(function(e){t[e.id]=e})}function f(e){this.allPageLinks=e,this.allPageLinks.sort(m)}function m(e,t){var n=e.textContent&&e.textContent.toLowerCase(),r=t.textContent&&t.textContent.toLowerCase();return r>n?-1:n>r?1:0}function p(e,t,n){var r=document.createElement("a");return r.href=e,r.target=t,r.classList.add("targetSelector"),r.textContent=n,r}var h;return i.mixin(d.prototype,{getCategoryIDs:function(){return Object.keys(this.categories)},getCategory:function(e){return this.categories[e]||null}}),i.mixin(f.prototype,{createLinkElements:function(){return this.allPageLinks.map(function(e){return p(e.href,"_self",e.textContent)})},getAllLinks:function(){return this.allPageLinks}}),{getCategoriesInfo:l,getPageLinksInfo:a,getOrionHome:s}}),define("orion/util",[],function(){function e(e){var t=arguments;return e.replace(/\$\{([^\}]+)\}/g,function(e,n){return t[(n<<0)+1]})}function t(e,t){return e.createElementNS?e.createElementNS(v,t):e.createElement(t)}var n=navigator.userAgent,r=-1!==n.indexOf("MSIE")||-1!==n.indexOf("Trident")?document.documentMode:void 0,o=parseFloat(n.split("Firefox/")[1]||n.split("Minefield/")[1])||void 0,i=-1!==n.indexOf("Opera")?parseFloat(n.split("Version/")[1]):void 0,s=parseFloat(n.split("Chrome/")[1])||void 0,a=-1!==n.indexOf("Safari")&&!s,u=parseFloat(n.split("WebKit/")[1])||void 0,c=-1!==n.indexOf("Android"),l=-1!==n.indexOf("iPad"),d=-1!==n.indexOf("iPhone"),f=l||d,m=-1!==navigator.platform.indexOf("Mac"),p=-1!==navigator.platform.indexOf("Win"),h=-1!==navigator.platform.indexOf("Linux"),y="undefined"!=typeof document&&"ontouchstart"in document.createElement("input"),g=p?"\r\n":"\n",v="http://www.w3.org/1999/xhtml";return{formatMessage:e,createElement:t,isIE:r,isFirefox:o,isOpera:i,isChrome:s,isSafari:a,isWebkit:u,isAndroid:c,isIPad:l,isIPhone:d,isIOS:f,isMac:m,isWindows:p,isLinux:h,isTouch:y,platformDelimiter:g}}),define("orion/webui/littlelib",["orion/util"],function(e){function t(e,t){return t||(t=document),t.querySelector(e)}function n(e,t){return t||(t=document),t.querySelectorAll(e)}function r(e,t){return Array.prototype.slice.call(n(e,t))}function o(e){var t=e;return"string"==typeof e&&(t=document.getElementById(e)),t}function i(e,t){if(!e||!t)return!1;if(e===t)return!0;var n=e.compareDocumentPosition(t);return Boolean(16&n)}function s(e){var t=e.getBoundingClientRect(),n=Math.max(document.documentElement.scrollLeft,document.body.scrollLeft),r=Math.max(document.documentElement.scrollTop,document.body.scrollTop);return{left:t.left+n,top:t.top+r,width:t.width,height:t.height}}function a(e){for(;e.hasChildNodes();){var t=e.firstChild;e.removeChild(t)}}function u(t){var n=t.tabIndex;if(0===n&&e.isIE){var r={a:!0,body:!0,button:!0,frame:!0,iframe:!0,img:!0,input:!0,isindex:!0,object:!0,select:!0,textarea:!0};r[t.nodeName.toLowerCase()]||t.attributes.tabIndex||(n=-1)}return n}function c(e){if(u(e)>=0)return e;if(e.hasChildNodes())for(var t=0;t<e.childNodes.length;t++){var n=c(e.childNodes[t]);if(n)return n}return null}function l(e){if(u(e)>=0)return e;if(e.hasChildNodes())for(var t=e.childNodes.length-1;t>=0;t--){var n=l(e.childNodes[t]);if(n)return n}return null}function d(e,t){if(3===e.nodeType){var n=b.exec(e.nodeValue);n&&n.length>1&&t(e,n)}if(e.hasChildNodes())for(var r=0;r<e.childNodes.length;r++)d(e.childNodes[r],t)}function f(e,t){d(e,function(e,n){var r=t[n[1]]||n[1];e.parentNode.replaceChild(document.createTextNode(r),e)})}function m(e,t){d(e,function(e,n){var r=t[n[1]];if(r){var o=document.createRange(),i=n.index;o.setStart(e,i),o.setEnd(e,i+n[0].length),o.deleteContents(),o.insertNode(r)}})}function p(t,n){function r(e){I.forEach(function(t){var n=!1,r=t.excludeNodes.some(function(t){return document.body.contains(t)?(n=!0,t.contains(e.target)):!1});if(n&&!r)try{t.dismiss(e)}catch(o){"undefined"!=typeof console&&console&&console.error(o&&o.message)}}),I=I.filter(function(e){return e.excludeNodes.some(function(e){return document.body.contains(e)})})}null===I&&(I=[],document.addEventListener("click",r,!0),e.isIOS&&document.addEventListener("touchend",function(e){function t(){e.target.removeEventListener("click",t)}0===e.touches.length&&e.target.addEventListener("click",t)},!1)),I.push({excludeNodes:t,dismiss:n})}function h(e){I=I.filter(function(t){return e!==t.dismiss})}function y(e){for(var t=e.parentNode,n=document.documentElement;t&&t!==n;){var r=window.getComputedStyle(t,null);if(!r)break;var o=r.getPropertyValue("overflow-y");if("auto"===o||"scroll"===o)break;t=t.parentNode}return t}function g(e){window.document.all&&(e.keyCode=0),e.preventDefault&&(e.preventDefault(),e.stopPropagation())}function v(e){for(var t=document.getElementsByTagName("iframe"),n=0;n<t.length;n++)t[n].parentNode.style.pointerEvents=e?"":"none"}function E(e){return R[e]||null}function w(e,t){var n=t,r=null;return void 0===n&&(n=document.createElement("div")),n.innerHTML=e,r=1<n.childNodes.length?n.childNodes:n.firstChild}var b=/\$\{([^\}]+)\}/,I=null,_={BKSPC:8,TAB:9,ENTER:13,ESCAPE:27,SPACE:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DEL:46},R=Object.create(null);return Object.keys(_).forEach(function(e){R[_[e]]=e}),{$:t,$$:n,$$array:r,node:o,contains:i,bounds:s,empty:a,firstTabbable:c,lastTabbable:l,stop:g,processTextNodes:f,processDOMNodes:m,addAutoDismiss:p,setFramesEnabled:v,getOffsetParent:y,removeAutoDismiss:h,keyName:E,KEY:_,createNodes:w}}),define("mixloginstatic/LoginWindow",["domReady","orion/xhr","orion/PageUtil","orion/PageLinks","orion/webui/littlelib","orion/xsrfUtils"],function(e,t,n,r,o,i){function s(e){var t=new RegExp("[\\?&]"+e+"=([^&#]*)"),n=t.exec(window.location.href);return null!==n?n[1]:void 0}function a(e){var t,n,r,o,i,s,a,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="",l=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");l<e.length;)o=u.indexOf(e.charAt(l++)),i=u.indexOf(e.charAt(l++)),s=u.indexOf(e.charAt(l++)),a=u.indexOf(e.charAt(l++)),t=o<<2|i>>4,n=(15&i)<<4|s>>2,r=(3&s)<<6|a,c+=String.fromCharCode(t),64!==s&&(c+=String.fromCharCode(n)),64!==a&&(c+=String.fromCharCode(r));c=c.replace(/\r\n/g,"\n");for(var d="",f=0;f<c.length;f++){var m=c.charCodeAt(f);128>m?d+=String.fromCharCode(m):m>127&&2048>m?(d+=String.fromCharCode(m>>6|192),d+=String.fromCharCode(63&m|128)):(d+=String.fromCharCode(m>>12|224),d+=String.fromCharCode(m>>6&63|128),d+=String.fromCharCode(63&m|128))}return d}function u(e){"undefined"!=typeof e&&(document.getElementById("errorMessage").textContent=e),document.getElementById("errorWin").style.visibility=""}function c(){document.getElementById("errorMessage").textContent=" ",document.getElementById("errorWin").style.visibility="hidden"}function l(e,t){u(t)}function d(){var e;if(""===document.getElementById("reset").value&&""===document.getElementById("resetEmail").value)return void l(!0,"Provide username or email to reset.");var t=document.getElementById("reset").value,n=document.getElementById("resetEmail").value,r=new XMLHttpRequest;r.onreadystatechange=function(){if(c(),4===r.readyState)if(200===r.status)e=JSON.parse(r.responseText),e.Message?l(!1,e.Message):u();else{try{if(e=JSON.parse(r.responseText),e.Message)return void l(!0,e.Message)}catch(t){}l(!0,r.statusText)}};var o={UserName:t,Email:n};r.open("POST","../useremailconfirmation",!0),r.setRequestHeader("Content-type","application/json;charset=UTF-8"),r.setRequestHeader("Orion-Version","1"),i.addCSRFNonce(r),r.send(JSON.stringify(o)),l(!1,"Sending password reset confirmation...")}function f(){var e=new RegExp("[\\?&]redirect=([^&#]*)"),t=e.exec(window.location.href);return null===t?null:t[1]}function m(){var e=f();return e=null===e?r.getOrionHome():e,null!==e&&(e=decodeURIComponent(e),n.validateURLScheme(e))?void(window.location=e):void window.close()}function p(e){if(""!==e&&null!==e){var t=f();return null!==t&&n.validateURLScheme(decodeURIComponent(t))?"../login/oauth?oauth="+e+"&redirect="+t:"../login/oauth?oauth="+e}}function h(e){var t=!1;return("click"===e.type||13===e.keyCode)&&(t=!0),e.stopPropagation(),t}function y(e,t){if(e||(e=document.getElementById("username").value.trim(),t=document.getElementById("password").value),e.length>0&&t.length>0){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(4===n.readyState)if(200!==n.status&&-1!==window.location.href.indexOf("http")){var e=JSON.parse(n.responseText);u(e.error)}else m()};var r="username="+encodeURIComponent(e)+"&password="+encodeURIComponent(t);n.open("POST","../login/form",!0),n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),n.setRequestHeader("Orion-Version","1"),i.addCSRFNonce(n),n.send(r)}}function g(){return document.getElementById("create_password").value!==document.getElementById("create_passwordRetype").value?(u("Passwords don't match!"),!1):(c(),!0)}function v(){document.getElementById("newUserHeaderShown").style.visibility="hidden",document.getElementById("orionOpen").style.visibility="",(O||k)&&(document.getElementById("orionRegister").style.visibility=""),document.getElementById("registerButton").focus()}function E(){document.getElementById("createLinkedHeaderShown").style.visibility="hidden",document.getElementById("orionOpen").style.visibility="",(O||k)&&(document.getElementById("orionRegister").style.visibility=""),document.getElementById("registerButton").focus()}function w(){if(!g())return document.getElementById("create_password").setAttribute("aria-invalid","true"),void document.getElementById("create_passwordRetype").setAttribute("aria-invalid","true");document.getElementById("create_password").setAttribute("aria-invalid","false"),document.getElementById("create_passwordRetype").setAttribute("aria-invalid","false");var e=new XMLHttpRequest,t=document.getElementById("create_username").value,n=document.getElementById("create_password").value,r=document.getElementById("create_email").value;e.onreadystatechange=function(){if(4===e.readyState)if(201!==e.status&&-1!==window.location.href.indexOf("http")){if(!e.responseText)return;var r=JSON.parse(e.responseText);u(r.Message),v()}else y(t,n)};var o={UserName:t,Password:n,Email:r};e.open("POST","../users",!0),e.setRequestHeader("Content-type","application/json;charset=UTF-8"),e.setRequestHeader("Orion-Version","1"),i.addCSRFNonce(e),e.send(JSON.stringify(o))}function b(){var e=document.getElementById("create_linked_username").value,t=document.getElementById("create_linked_email").value,n=s("identifier"),r=I(),o=new XMLHttpRequest;o.onreadystatechange=function(){if(4===o.readyState)if(200!==o.status&&-1!==window.location.href.indexOf("http")){if(!o.responseText)return;var t=JSON.parse(o.responseText);u(t.Message),201===o.status&&E()}else y(e,r)};{var a={UserName:e,Password:r,Email:t,identifier:n};"username="+encodeURIComponent(e)+"&password="+encodeURIComponent(r)+"&identifier="+encodeURIComponent(n)+"&Email="+encodeURIComponent(t)}o.open("POST","../users",!0),o.setRequestHeader("Content-type","application/json;charset=UTF-8"),o.setRequestHeader("Orion-Version","1"),i.addCSRFNonce(o),o.send(JSON.stringify(a))}function I(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",t="0123456789",n=7,r="",o=0;n>o;o++)r+=e.charAt(Math.floor(Math.random()*e.length));for(var o=0;n>o;o++)r+=t.charAt(Math.floor(Math.random()*t.length));return r}function _(e){if(h(e)){if(!O&&k)return void window.open(k);document.getElementById("orionOpen").style.visibility="hidden",document.getElementById("orionRegister").style.visibility="hidden",document.getElementById("orionLoginForm").style.visibility="hidden",document.getElementById("orionRegister").style.visibility="hidden",document.getElementById("newUserHeaderShown").style.visibility="",document.getElementById("create_username").focus()}}function R(e,t){document.getElementById("orionOpen").style.visibility="hidden",document.getElementById("orionRegister").style.visibility="hidden",document.getElementById("orionLoginForm").style.visibility="hidden",document.getElementById("orionRegister").style.visibility="hidden",document.getElementById("createLinkedHeaderShown").style.visibility="",document.getElementById("create_linked_username").focus(),document.getElementById("create_linked_username").value=t,document.getElementById("create_linked_email").value=e}function x(){document.getElementById("orionRegister").style.visibility="hidden"}function C(){document.getElementById("orionLoginForm").style.visibility="hidden",O||k||(document.getElementById("orionRegister").style.visibility="hidden",document.getElementById("orionReset").style.height="212px"),document.getElementById("newUserHeaderShown").style.display="none",document.getElementById("orionReset").style.visibility="",document.getElementById("reset").focus()}function B(){document.getElementById("orionLoginForm").style.visibility="",document.getElementById("newUserHeaderShown").style.display="",document.getElementById("orionReset").style.visibility="hidden"}function L(e){h(e)&&(o.stop(e),document.getElementById("orionOpen").style.visibility="hidden",document.getElementById("orionRegister").style.visibility="hidden",document.getElementById("orionLoginForm").style.visibility="",document.getElementById("username").focus())
}function U(){document.getElementById("orionLoginForm").style.visibility="hidden",document.getElementById("orionOpen").style.visibility="",(O||k)&&(document.getElementById("orionRegister").style.visibility=""),document.getElementById("orionLogin").focus(),c()}function S(e){h(e)&&e.srcElement.click()}var O,k,T,N="ga";e(function(){var e=new URL("../metrics",window.location);t("GET",e.href,{headers:{"Orion-Version":"1"},log:!1}).then(function(e){if(e=JSON.parse(e.response),e.tid){!function(e,t,n,r,o,i,s){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),s=t.getElementsByTagName(n)[0],i.async=1,i.src=r,s.parentNode.insertBefore(i,s)}(window,document,"script","//www.google-analytics.com/analytics.js",N);var t={};e.siteSpeedSampleRate&&(t.siteSpeedSampleRate=e.siteSpeedSampleRate),window[N]("create",e.tid,t),window[N]("send","pageview")}});var n=s("error");if(n){var r=a(n);u(r)}var c=s("oauth");if(c){var l=s("email"),f=s("username");R(l,f)}var m=new XMLHttpRequest;m.onreadystatechange=function(){if(4===m.readyState&&200===m.status){var e=JSON.parse(m.responseText);O=e.CanAddUsers,T=e.ForceEmail,document.getElementById("create_email").setAttribute("aria-required",T),k=e.RegistrationURI,O||k||x(),document.getElementById("login-window").style.display="",document.getElementById("orionLogin").focus()}},m.open("POST","../login/canaddusers",!0),m.setRequestHeader("Content-type","application/x-www-form-urlencoded"),m.setRequestHeader("Orion-Version","1"),i.addCSRFNonce(m),m.send();var h=new XMLHttpRequest;h.onreadystatechange=function(){if(4===h.readyState&&200===h.status){var e=JSON.parse(h.responseText);e.EmailConfigured===!1&&(document.getElementById("resetUserLink").style.display="none")}},h.open("POST","../useremailconfirmation/cansendemails",!0),h.setRequestHeader("Content-type","application/x-www-form-urlencoded"),h.setRequestHeader("Orion-Version","1"),h.send(),t("GET","../server-status.json",{timeout:15e3,responseType:"json"}).then(function(e){var t=e.response.messages;if(t.length>0){var n=new Date,r=new Date(t[0].startdate);if(r.setHours(0,0,0,0),r>n)return;var o=new Date(t[0].enddate);if(o.setHours(23,59,59),n>=o)return;document.getElementById("orionInfoArea").style.visibility="",document.getElementById("orionInfoMessage").textContent=t[0].title}},function(){}),document.getElementById("username").addEventListener("keypress",function(e){e.keyCode===o.KEY.ENTER&&(y(),o.stop(e))}),document.getElementById("password").addEventListener("keypress",function(e){e.keyCode===o.KEY.ENTER&&(y(),o.stop(e))}),document.getElementById("loginButton").addEventListener("click",function(){y()}),document.getElementById("orionLoginForm").addEventListener("keyup",function(e){e.keyCode===o.KEY.ESCAPE&&(U(),o.stop(e))}),document.getElementById("resetUserLink").addEventListener("click",C),document.getElementById("reset").addEventListener("keypress",function(e){e.keyCode===o.KEY.ENTER&&(d(),o.stop(e))}),document.getElementById("resetEmail").addEventListener("keypress",function(e){e.keyCode===o.KEY.ENTER&&(d(),o.stop(e))}),document.getElementById("registerButton").addEventListener("click",_),document.getElementById("registerButton").addEventListener("keydown",_),document.getElementById("create_username").addEventListener("keyup",function(e){e.keyCode===o.KEY.ENTER?w():g()}),document.getElementById("create_password").addEventListener("keyup",function(e){e.keyCode===o.KEY.ENTER?w():g()}),document.getElementById("create_passwordRetype").addEventListener("keyup",function(e){e.keyCode===o.KEY.ENTER?w():g()}),document.getElementById("create_email").addEventListener("keyup",function(e){e.keyCode===o.KEY.ENTER?w():g()}),document.getElementById("newUserHeaderShown").addEventListener("keyup",function(e){e.keyCode===o.KEY.ESCAPE&&v()}),document.getElementById("createButton").addEventListener("click",w),document.getElementById("cancelLoginButton").addEventListener("click",U),document.getElementById("newUserHeaderShown").onkeyup=function(e){e.keyCode===o.KEY.ESCAPE&&v()},document.getElementById("hideRegisterButton").addEventListener("click",v),document.getElementById("createLinkedButton").addEventListener("click",b),document.getElementById("hideLinkedRegisterButton").addEventListener("click",E),document.getElementById("googleLoginPlus").href=p("google"),document.getElementById("googleLoginPlus").addEventListener("keydown",S),document.getElementById("githubLogin").href=p("github"),document.getElementById("githubLogin").addEventListener("keydown",S),document.getElementById("orionLogin").addEventListener("click",L),document.getElementById("orionLogin").onkeydown=L,document.getElementById("cancelResetButton").onclick=B,document.getElementById("sendResetButton").onclick=d})});