!function(e,n){"function"==typeof define&&define.amd?define("orion/Deferred",n):"object"==typeof exports?module.exports=n():(e.orion=e.orion||{},e.orion.Deferred=n())}(this,function(){function e(){for(var e;e=i.shift();)e();c=!1}function n(e){i.push(e),c||(c=!0,a())}function t(e){return function(n){e(n)}}function o(e,n,o){try{var r=e(n),i=r&&("object"==typeof r||"function"==typeof r)&&r.then;if("function"==typeof i)if(r===o.promise)o.reject(new TypeError);else{var c=r.cancel;"function"==typeof c?o._parentCancel=c.bind(r):delete o._parentCancel,i.call(r,t(o.resolve),t(o.reject),t(o.progress))}else o.resolve(r)}catch(a){o.reject(a)}}function r(){function e(){for(var e;e=l.shift();){var n=e.deferred,t="fulfilled"===s?"resolve":"reject",r=e[t];"function"==typeof r?o(r,a,n):n[t](a)}}function t(t){delete u._parentCancel,s="rejected",a=t,l.length&&n(e)}function i(o){function c(e){return function(n){s&&"assumed"!==s||e(n)}}delete u._parentCancel;try{var d=o&&("object"==typeof o||"function"==typeof o)&&o.then;if("function"==typeof d)if(o===u)t(new TypeError);else{s="assumed";var f=o&&o.cancel;if("function"!=typeof f){var m=new r;o=m.promise;try{d(m.resolve,m.reject,m.progress)}catch(p){m.reject(p)}f=o.cancel,d=o.then}a=o,d.call(o,c(i),c(t)),u._parentCancel=f.bind(o)}else s="fulfilled",a=o,l.length&&n(e)}catch(h){c(t)(h)}}function c(){var e=u._parentCancel;if(e)delete u._parentCancel,e();else if(!s){var n=new Error("Cancel");n.name="Cancel",t(n)}}var a,s,l=[],u=this;this.resolve=function(e){return s||i(e),u},this.reject=function(e){return s||t(e),u},this.progress=function(e){return s||l.forEach(function(n){if(n.progress)try{n.progress(e)}catch(t){}}),u.promise},this.cancel=function(){return u._parentCancel?setTimeout(c,0):c(),u},this.then=function(t,o,i){var c=new r;return c._parentCancel=u.promise.cancel,l.push({resolve:t,reject:o,progress:i,deferred:c}),("fulfilled"===s||"rejected"===s)&&n(e),c.promise},this.promise={then:u.then,cancel:u.cancel}}var i=[],c=!1,a=function(){if("undefined"!=typeof process&&"function"==typeof process.nextTick){var n=process.nextTick;return function(){n(e)}}if("function"==typeof MutationObserver){var t=document.createElement("div"),o=new MutationObserver(e);return o.observe(t,{attributes:!0}),function(){t.setAttribute("class","_tick")}}return function(){setTimeout(e,0)}}();return r.all=function(e,n){function t(e,n){a||(c[e]=n,0===--i&&s.resolve(c))}function o(e,o){if(!a){if(n)try{return void t(e,n(o))}catch(r){o=r}s.reject(o)}}var i=e.length,c=[],a=!1,s=new r;return s.then(void 0,function(){a=!0,e.forEach(function(e){e.cancel&&e.cancel()})}),0===i?s.resolve(c):e.forEach(function(e,n){e.then(t.bind(void 0,n),o.bind(void 0,n))}),s.promise},r.when=function(e,n,t,o){var i,c;return e&&"function"==typeof e.then?i=e:(c=new r,c.resolve(e),i=c.promise),i.then(n,t,o)},r}),function(e,n){"function"==typeof define&&define.amd?define("orion/plugin",["orion/Deferred"],n):"object"==typeof exports?module.exports=n(require("orion/Deferred")):(e.orion=e.orion||{},e.orion.PluginProvider=n(e.orion.Deferred))}(this,function(e){function n(e,n){this.__objectId=e,this.__methods=n}function t(t){function o(e){_&&("undefined"==typeof ArrayBuffer&&(e=JSON.stringify(e)),_===self?_.postMessage(e):_.postMessage(e,"*"))}function r(){var e=[];return Object.keys(y).forEach(function(n){var t=y[n];e.push({serviceId:n,names:t.names,methods:t.methods,properties:t.properties})}),{headers:d||{},services:e}}function i(e,n){if(n&&n instanceof XMLHttpRequest){var t,o;try{t=n.status,o=n.statusText}catch(r){t=0,o=""}return{status:t||0,statusText:o}}return n}function c(e){var n=e?JSON.parse(JSON.stringify(e,i)):e;return e instanceof Error&&(n.__isError=!0,n.message=n.message||e.message,n.name=n.name||e.name),n}function a(t){if(!_)return(new e).reject(new Error("plugin not connected"));t.id=String(m++);var o=new e;v[t.id]=o,o.then(null,function(e){f&&e instanceof Error&&"Cancel"===e.name&&j({requestId:t.id,method:"cancel",params:e.message?[e.message]:[]})});var r=Object.prototype.toString;return t.params.forEach(function(e,i){if("[object Object]"===r.call(e)&&!(e instanceof n)){var c,a;for(c in e)"[object Function]"===r.call(e[c])&&(a=a||[],a.push(c));if(a){var s=p++;g[s]=e;var l=function(){delete g[s]};o.then(l,l),t.params[i]=new n(s,a)}}}),j(t),o.promise}function s(e,n){e||0===e?j({id:e,result:null,error:n}):console.log(n)}function l(e,n,t,o){o.forEach(function(e,n){if(e&&"undefined"!=typeof e.__objectId){var t={};e.__methods.forEach(function(n){t[n]=function(){return a({objectId:e.__objectId,method:n,params:Array.prototype.slice.call(arguments)})}}),o[n]=t}});var r="undefined"==typeof e?null:{id:e,result:null,error:null};try{var i=t.apply(n,o);if(!r)return;i&&"function"==typeof i.then?(b[e]=i,i.then(function(n){delete b[e],r.result=n,j(r)},function(n){b[e]&&(delete b[e],r.error=c(n),j(r))},function(){j({responseId:e,method:"progress",params:Array.prototype.slice.call(arguments)})})):(r.result=i,j(r))}catch(s){r&&(r.error=c(s),j(r))}}function u(e){if(e.source===_||"undefined"==typeof window){var n="string"!=typeof e.data?e.data:JSON.parse(e.data);try{if(n.method){var t=n.method,o=n.params||[];if("serviceId"in n){var r=y[n.serviceId];r||s(n.id,"service not found"),r=r.implementation,t in r?l(n.id,r,r[t],o):s(n.id,"method not found")}else if("objectId"in n){var i=g[n.objectId];i||s(n.id,"object not found"),!t in i?l(n.id,i,i[t],o):s(n.id,"method not found")}else if("requestId"in n){var c=b[n.requestId];c&&"cancel"===t&&c.cancel&&c.cancel.apply(c,o)}else{if(!("responseId"in n))throw new Error("Bad method: "+n.method);var a=v[n.responseId];a&&"progress"===t&&a.progress&&a.progress.apply(a,o)}}else{var u=v[String(n.id)];delete v[String(n.id)],n.error?u.reject(n.error):u.resolve(n.result)}}catch(d){console.log("Plugin._messageHandler "+d)}}}var d=t,f=!1,m=0,p=0,h=0,b={},v={},g={},y={},_=null;"undefined"==typeof window?_=self:window!==window.parent?_=window.parent:null!==window.opener&&(_=window.opener);var j=o;o({method:"loading"}),this.updateHeaders=function(e){if(f)throw new Error("Cannot update headers. Plugin Provider is connected");d=e},this.registerService=function(e,n,t){if(f)throw new Error("Cannot register service. Plugin Provider is connected");"string"==typeof e?e=[e]:Array.isArray(e)||(e=[]);var o=null,r=[];for(o in n)"function"==typeof n[o]&&r.push(o);y[h++]={names:e,methods:r,implementation:n,properties:t||{},listeners:{}}},this.registerServiceProvider=this.registerService,this.connect=function(e,n){if(f)return void(e&&e());if(!_)return void(n&&n("No valid plugin target"));addEventListener("message",u,!1);var t={method:"plugin",params:[r()]};o(t),f=!0,e&&e()},this.disconnect=function(){f&&(removeEventListener("message",u),_=null,f=!1)}}return t}),define("orion/editor/stylers/lib/syntax",[],function(){return{id:"orion.lib",grammars:[{id:"orion.lib",repository:{brace_open:{match:"{",name:"punctuation.section.block.begin"},brace_close:{match:"}",name:"punctuation.section.block.end"},bracket_open:{match:"\\[",name:"punctuation.section.bracket.begin"},bracket_close:{match:"\\]",name:"punctuation.section.bracket.end"},parenthesis_open:{match:"\\(",name:"punctuation.section.parens.begin"},parenthesis_close:{match:"\\)",name:"punctuation.section.parens.end"},doc_block:{begin:{match:"/\\*\\*",literal:"/**"},end:{match:"\\*/",literal:"*/"},name:"comment.block.documentation",patterns:[{match:"@(?:(?!\\*/)\\S)*",name:"meta.documentation.annotation"},{match:"<[^\\s>]*>",name:"meta.documentation.tag"},{match:"(\\b)(TODO)(\\b)(((?!\\*/).)*)",name:"meta.annotation.task.todo",captures:{2:{name:"keyword.other.documentation.task"},4:{name:"comment.block"}}}]},number_decimal:{match:"\\b-?(?:\\.\\d+|\\d+\\.?\\d*)(?:[eE][+-]?\\d+)?\\b",name:"constant.numeric.number"},number_hex:{match:"\\b0[xX][0-9A-Fa-f]+\\b",name:"constant.numeric.hex"},string_doubleQuote:{match:'"(?:\\\\.|[^"])*"?',name:"string.quoted.double"},string_singleQuote:{match:"'(?:\\\\.|[^'])*'?",name:"string.quoted.single"},todo_comment_singleLine:{match:"(\\b)(TODO)(\\b)(.*)",name:"meta.annotation.task.todo",captures:{2:{name:"keyword.other.documentation.task"},4:{name:"comment.line"}}}}},{id:"orion.c-like",repository:{comment_singleLine:{match:{match:"//.*",literal:"//"},name:"comment.line.double-slash",patterns:[{include:"orion.lib#todo_comment_singleLine"}]},comment_block:{begin:{match:"/\\*",literal:"/*"},end:{match:"\\*/",literal:"*/"},name:"comment.block",patterns:[{match:"(\\b)(TODO)(\\b)(((?!\\*/).)*)",name:"meta.annotation.task.todo",captures:{2:{name:"keyword.other.documentation.task"},4:{name:"comment.block"}}}]}}}],keywords:[]}}),define("orion/editor/stylers/text_x-csrc/syntax",["orion/editor/stylers/lib/syntax"],function(e){var n=["auto","break","case","char","const","continue","default","double","do","else","enum","extern","float","for","goto","if","inline","int","long","register","return","short","signed","sizeof","static","struct","switch","typedef","union","unsigned","void","volatile","while","_Bool","_Complex","_Imaginary"],t=["define","elif","else","endif","error","ifdef","ifndef","if","include","line","pragma","undef"],o=[];return o.push.apply(o,e.grammars),o.push({id:"orion.c",contentTypes:["text/x-csrc","text/x-c"],patterns:[{include:"orion.lib#string_doubleQuote"},{include:"orion.lib#string_singleQuote"},{include:"orion.c-like#comment_singleLine"},{include:"orion.lib#doc_block"},{include:"orion.c-like#comment_block"},{include:"#directive"},{include:"orion.lib#brace_open"},{include:"orion.lib#brace_close"},{include:"orion.lib#bracket_open"},{include:"orion.lib#bracket_close"},{include:"orion.lib#parenthesis_open"},{include:"orion.lib#parenthesis_close"},{include:"orion.lib#number_decimal"},{include:"orion.lib#number_hex"},{match:"\\b(?:"+n.join("|")+")\\b",name:"keyword.control.c"}],repository:{directive:{match:"(#\\s*(?:"+t.join("|")+"))\\b",name:"keyword.control.directive.c"}}}),{id:o[o.length-1].id,grammars:o,keywords:n.concat(t)}}),define("orion/editor/stylers/text_x-objective-c/syntax",["orion/editor/stylers/text_x-csrc/syntax"],function(e){var n=["atomic","BOOL","bycopy","byref","Class","id","IMP","inout","in","nil","nonatomic","NO","NULL","oneway","out","Protocol","retain","SEL","self","super","YES"],t=["@catch","@class","@dynamic","@end","@finally","@implementation","@interface","@private","@property","@protected","@protocol","@public","@selector","@synthesize","@throw","@try"],o=["import"],r=[];return r.push.apply(r,e.grammars),r.push({id:"orion.objectiveC",contentTypes:["text/x-objective-c"],patterns:[{include:"#objectiveCString"},{include:"orion.c"},{include:"#objectiveCDirective"},{include:"#objectiveCKeyword"}],repository:{objectiveCDirective:{match:"(#\\s*(?:"+o.join("|")+"))\\b",name:"keyword.control.directive.objective-c"},objectiveCKeyword:{match:"(\\b(?:"+n.join("|")+")|(?:"+t.join("|")+"))\\b",name:"keyword.control.objective-c"},objectiveCString:{match:'@"(?:\\\\.|[^"])*"?',name:"string.quoted.double.objective-c"}}}),{id:r[r.length-1].id,grammars:r,keywords:e.keywords.concat(n).concat(o).concat(t)}}),define("plugins/languages/objectiveC/objectiveCPlugin",["orion/plugin","orion/editor/stylers/text_x-objective-c/syntax"],function(e,n){function t(){var n={name:"Orion Objective-C Tool Support",version:"1.0",description:"This plugin provides Objective-C tools support for Orion."},t=new e(n);o(t),t.connect()}function o(e){e.registerServiceProvider("orion.core.contenttype",{},{contentTypes:[{id:"text/x-objective-c","extends":"text/plain",name:"Objective-C",extension:["m","mm","h"]}]}),e.registerServiceProvider("orion.edit.highlighter",{},n.grammars[n.grammars.length-1])}return{connect:t,registerServiceProviders:o}});