!function(e,n){"function"==typeof define&&define.amd?define("orion/Deferred",n):"object"==typeof exports?module.exports=n():(e.orion=e.orion||{},e.orion.Deferred=n())}(this,function(){function e(){for(var e;e=i.shift();)e();a=!1}function n(e){i.push(e),a||(a=!0,s())}function t(e){return function(n){e(n)}}function r(e,n,r){try{var o=e(n),i=o&&("object"==typeof o||"function"==typeof o)&&o.then;if("function"==typeof i)if(o===r.promise)r.reject(new TypeError);else{var a=o.cancel;"function"==typeof a?r._parentCancel=a.bind(o):delete r._parentCancel,i.call(o,t(r.resolve),t(r.reject),t(r.progress))}else r.resolve(o)}catch(s){r.reject(s)}}function o(){function e(){for(var e;e=u.shift();){var n=e.deferred,t="fulfilled"===c?"resolve":"reject",o=e[t];"function"==typeof o?r(o,s,n):n[t](s)}}function t(t){delete f._parentCancel,c="rejected",s=t,u.length&&n(e)}function i(r){function a(e){return function(n){c&&"assumed"!==c||e(n)}}delete f._parentCancel;try{var l=r&&("object"==typeof r||"function"==typeof r)&&r.then;if("function"==typeof l)if(r===f)t(new TypeError);else{c="assumed";var d=r&&r.cancel;if("function"!=typeof d){var p=new o;r=p.promise;try{l(p.resolve,p.reject,p.progress)}catch(m){p.reject(m)}d=r.cancel,l=r.then}s=r,l.call(r,a(i),a(t)),f._parentCancel=d.bind(r)}else c="fulfilled",s=r,u.length&&n(e)}catch(h){a(t)(h)}}function a(){var e=f._parentCancel;if(e)delete f._parentCancel,e();else if(!c){var n=new Error("Cancel");n.name="Cancel",t(n)}}var s,c,u=[],f=this;this.resolve=function(e){return c||i(e),f},this.reject=function(e){return c||t(e),f},this.progress=function(e){return c||u.forEach(function(n){if(n.progress)try{n.progress(e)}catch(t){}}),f.promise},this.cancel=function(){return f._parentCancel?setTimeout(a,0):a(),f},this.then=function(t,r,i){var a=new o;return a._parentCancel=f.promise.cancel,u.push({resolve:t,reject:r,progress:i,deferred:a}),("fulfilled"===c||"rejected"===c)&&n(e),a.promise},this.promise={then:f.then,cancel:f.cancel}}var i=[],a=!1,s=function(){if("undefined"!=typeof process&&"function"==typeof process.nextTick){var n=process.nextTick;return function(){n(e)}}if("function"==typeof MutationObserver){var t=document.createElement("div"),r=new MutationObserver(e);return r.observe(t,{attributes:!0}),function(){t.setAttribute("class","_tick")}}return function(){setTimeout(e,0)}}();return o.all=function(e,n){function t(e,n){s||(a[e]=n,0===--i&&c.resolve(a))}function r(e,r){if(!s){if(n)try{return void t(e,n(r))}catch(o){r=o}c.reject(r)}}var i=e.length,a=[],s=!1,c=new o;return c.then(void 0,function(){s=!0,e.forEach(function(e){e.cancel&&e.cancel()})}),0===i?c.resolve(a):e.forEach(function(e,n){e.then(t.bind(void 0,n),r.bind(void 0,n))}),c.promise},o.when=function(e,n,t,r){var i,a;return e&&"function"==typeof e.then?i=e:(a=new o,a.resolve(e),i=a.promise),i.then(n,t,r)},o}),function(e,n){"function"==typeof define&&define.amd?define("orion/plugin",["orion/Deferred"],n):"object"==typeof exports?module.exports=n(require("orion/Deferred")):(e.orion=e.orion||{},e.orion.PluginProvider=n(e.orion.Deferred))}(this,function(e){function n(e,n){this.__objectId=e,this.__methods=n}function t(t){function r(e){b&&("undefined"==typeof ArrayBuffer&&(e=JSON.stringify(e)),b===self?b.postMessage(e):b.postMessage(e,"*"))}function o(){var e=[];return Object.keys(w).forEach(function(n){var t=w[n];e.push({serviceId:n,names:t.names,methods:t.methods,properties:t.properties})}),{headers:l||{},services:e}}function i(e,n){if(n&&n instanceof XMLHttpRequest){var t,r;try{t=n.status,r=n.statusText}catch(o){t=0,r=""}return{status:t||0,statusText:r}}return n}function a(e){var n=e?JSON.parse(JSON.stringify(e,i)):e;return e instanceof Error&&(n.__isError=!0,n.message=n.message||e.message,n.name=n.name||e.name),n}function s(t){if(!b)return(new e).reject(new Error("plugin not connected"));t.id=String(p++);var r=new e;y[t.id]=r,r.then(null,function(e){d&&e instanceof Error&&"Cancel"===e.name&&j({requestId:t.id,method:"cancel",params:e.message?[e.message]:[]})});var o=Object.prototype.toString;return t.params.forEach(function(e,i){if("[object Object]"===o.call(e)&&!(e instanceof n)){var a,s;for(a in e)"[object Function]"===o.call(e[a])&&(s=s||[],s.push(a));if(s){var c=m++;g[c]=e;var u=function(){delete g[c]};r.then(u,u),t.params[i]=new n(c,s)}}}),j(t),r.promise}function c(e,n){e||0===e?j({id:e,result:null,error:n}):console.log(n)}function u(e,n,t,r){r.forEach(function(e,n){if(e&&"undefined"!=typeof e.__objectId){var t={};e.__methods.forEach(function(n){t[n]=function(){return s({objectId:e.__objectId,method:n,params:Array.prototype.slice.call(arguments)})}}),r[n]=t}});var o="undefined"==typeof e?null:{id:e,result:null,error:null};try{var i=t.apply(n,r);if(!o)return;i&&"function"==typeof i.then?(v[e]=i,i.then(function(n){delete v[e],o.result=n,j(o)},function(n){v[e]&&(delete v[e],o.error=a(n),j(o))},function(){j({responseId:e,method:"progress",params:Array.prototype.slice.call(arguments)})})):(o.result=i,j(o))}catch(c){o&&(o.error=a(c),j(o))}}function f(e){if(e.source===b||"undefined"==typeof window){var n="string"!=typeof e.data?e.data:JSON.parse(e.data);try{if(n.method){var t=n.method,r=n.params||[];if("serviceId"in n){var o=w[n.serviceId];o||c(n.id,"service not found"),o=o.implementation,t in o?u(n.id,o,o[t],r):c(n.id,"method not found")}else if("objectId"in n){var i=g[n.objectId];i||c(n.id,"object not found"),!t in i?u(n.id,i,i[t],r):c(n.id,"method not found")}else if("requestId"in n){var a=v[n.requestId];a&&"cancel"===t&&a.cancel&&a.cancel.apply(a,r)}else{if(!("responseId"in n))throw new Error("Bad method: "+n.method);var s=y[n.responseId];s&&"progress"===t&&s.progress&&s.progress.apply(s,r)}}else{var f=y[String(n.id)];delete y[String(n.id)],n.error?f.reject(n.error):f.resolve(n.result)}}catch(l){console.log("Plugin._messageHandler "+l)}}}var l=t,d=!1,p=0,m=0,h=0,v={},y={},g={},w={},b=null;"undefined"==typeof window?b=self:window!==window.parent?b=window.parent:null!==window.opener&&(b=window.opener);var j=r;r({method:"loading"}),this.updateHeaders=function(e){if(d)throw new Error("Cannot update headers. Plugin Provider is connected");l=e},this.registerService=function(e,n,t){if(d)throw new Error("Cannot register service. Plugin Provider is connected");"string"==typeof e?e=[e]:Array.isArray(e)||(e=[]);var r=null,o=[];for(r in n)"function"==typeof n[r]&&o.push(r);w[h++]={names:e,methods:o,implementation:n,properties:t||{},listeners:{}}},this.registerServiceProvider=this.registerService,this.connect=function(e,n){if(d)return void(e&&e());if(!b)return void(n&&n("No valid plugin target"));addEventListener("message",f,!1);var t={method:"plugin",params:[o()]};r(t),d=!0,e&&e()},this.disconnect=function(){d&&(removeEventListener("message",f),b=null,d=!1)}}return t}),define("orion/editor/stylers/text_x-yaml/syntax",[],function(){var e=["false","null","true"],n=["!!bool","!!float","!!int","!!map","!!null","!!omap","!!seq","!!str"],t="orion.yaml",r={id:t,contentTypes:["text/x-yaml"],patterns:[{include:"#numberSignComment"},{match:"^%(?:YAML|TAG)\\s.*",name:"meta.directive.yaml"},{begin:"^.*?:(?:[\\t ]|$)",end:"$",contentName:"string.unquoted.yaml",beginCaptures:{0:{name:"entity.name.key.yaml"}},patterns:[{include:"#numberSignComment"},{match:"^\\s*[&*]\\s*$",name:"entity.name.tag.yaml"},{match:"(?i)^\\s*(?:"+e.join("|")+")\\s*$",name:"keyword.control.yaml"},{match:"(?i)^\\s*(?:"+n.join("|")+")\\b",name:"keyword.control.yaml"},{match:"(?i)^\\s*(?:-?[0-9]*(?:\\.[0-9]+)?(?:e[-+][1-9][0-9]*)?)\\s*$",name:"constant.numeric.yaml"},{match:"(?i)^\\s*(?:-?[1-9][0-9]*|0|-?\\.inf|\\.nan)\\s*$",name:"constant.numeric.yaml"}]},{match:"---|\\.\\.\\.",name:"meta.separator.yaml"}],repository:{numberSignComment:{begin:{match:"(?:^|\\s)#",literal:"#"},end:{match:"$",literal:""},name:"comment.line.number-sign.yaml",patterns:[{include:"orion.lib#todo_comment_singleLine"}]}}};return{id:t,grammars:[r],keywords:n.concat(e)}}),define("plugins/languages/yaml/yamlPlugin",["orion/plugin","orion/editor/stylers/text_x-yaml/syntax"],function(e,n){function t(){var n={name:"Orion YAML Tool Support",version:"1.0",description:"This plugin provides YAML tools support for Orion."},t=new e(n);r(t),t.connect()}function r(e){e.registerServiceProvider("orion.core.contenttype",{},{contentTypes:[{id:"text/x-yaml","extends":"text/plain",name:"YAML",extension:["yaml","yml"]}]}),e.registerServiceProvider("orion.edit.highlighter",{},n.grammars[n.grammars.length-1])}return{connect:t,registerServiceProviders:r}});