!function(e,t){"function"==typeof define&&define.amd?define("orion/Deferred",t):"object"==typeof exports?module.exports=t():(e.orion=e.orion||{},e.orion.Deferred=t())}(this,function(){function e(){for(var e;e=i.shift();)e();s=!1}function t(e){i.push(e),s||(s=!0,a())}function n(e){return function(t){e(t)}}function r(e,t,r){try{var o=e(t),i=o&&("object"==typeof o||"function"==typeof o)&&o.then;if("function"==typeof i)if(o===r.promise)r.reject(new TypeError);else{var s=o.cancel;"function"==typeof s?r._parentCancel=s.bind(o):delete r._parentCancel,i.call(o,n(r.resolve),n(r.reject),n(r.progress))}else r.resolve(o)}catch(a){r.reject(a)}}function o(){function e(){for(var e;e=l.shift();){var t=e.deferred,n="fulfilled"===u?"resolve":"reject",o=e[n];"function"==typeof o?r(o,a,t):t[n](a)}}function n(n){delete c._parentCancel,u="rejected",a=n,l.length&&t(e)}function i(r){function s(e){return function(t){u&&"assumed"!==u||e(t)}}delete c._parentCancel;try{var f=r&&("object"==typeof r||"function"==typeof r)&&r.then;if("function"==typeof f)if(r===c)n(new TypeError);else{u="assumed";var p=r&&r.cancel;if("function"!=typeof p){var h=new o;r=h.promise;try{f(h.resolve,h.reject,h.progress)}catch(d){h.reject(d)}p=r.cancel,f=r.then}a=r,f.call(r,s(i),s(n)),c._parentCancel=p.bind(r)}else u="fulfilled",a=r,l.length&&t(e)}catch(g){s(n)(g)}}function s(){var e=c._parentCancel;if(e)delete c._parentCancel,e();else if(!u){var t=new Error("Cancel");t.name="Cancel",n(t)}}var a,u,l=[],c=this;this.resolve=function(e){return u||i(e),c},this.reject=function(e){return u||n(e),c},this.progress=function(e){return u||l.forEach(function(t){if(t.progress)try{t.progress(e)}catch(n){}}),c.promise},this.cancel=function(){return c._parentCancel?setTimeout(s,0):s(),c},this.then=function(n,r,i){var s=new o;return s._parentCancel=c.promise.cancel,l.push({resolve:n,reject:r,progress:i,deferred:s}),("fulfilled"===u||"rejected"===u)&&t(e),s.promise},this.promise={then:c.then,cancel:c.cancel}}var i=[],s=!1,a=function(){if("undefined"!=typeof process&&"function"==typeof process.nextTick){var t=process.nextTick;return function(){t(e)}}if("function"==typeof MutationObserver){var n=document.createElement("div"),r=new MutationObserver(e);return r.observe(n,{attributes:!0}),function(){n.setAttribute("class","_tick")}}return function(){setTimeout(e,0)}}();return o.all=function(e,t){function n(e,t){a||(s[e]=t,0===--i&&u.resolve(s))}function r(e,r){if(!a){if(t)try{return void n(e,t(r))}catch(o){r=o}u.reject(r)}}var i=e.length,s=[],a=!1,u=new o;return u.then(void 0,function(){a=!0,e.forEach(function(e){e.cancel&&e.cancel()})}),0===i?u.resolve(s):e.forEach(function(e,t){e.then(n.bind(void 0,t),r.bind(void 0,t))}),u.promise},o.when=function(e,t,n,r){var i,s;return e&&"function"==typeof e.then?i=e:(s=new o,s.resolve(e),i=s.promise),i.then(t,n,r)},o}),function(e,t){"function"==typeof define&&define.amd?define("orion/plugin",["orion/Deferred"],t):"object"==typeof exports?module.exports=t(require("orion/Deferred")):(e.orion=e.orion||{},e.orion.PluginProvider=t(e.orion.Deferred))}(this,function(e){function t(e,t){this.__objectId=e,this.__methods=t}function n(n){function r(e){w&&("undefined"==typeof ArrayBuffer&&(e=JSON.stringify(e)),w===self?w.postMessage(e):w.postMessage(e,"*"))}function o(){var e=[];return Object.keys(b).forEach(function(t){var n=b[t];e.push({serviceId:t,names:n.names,methods:n.methods,properties:n.properties})}),{headers:f||{},services:e}}function i(e,t){if(t&&t instanceof XMLHttpRequest){var n,r;try{n=t.status,r=t.statusText}catch(o){n=0,r=""}return{status:n||0,statusText:r}}return t}function s(e){var t=e?JSON.parse(JSON.stringify(e,i)):e;return e instanceof Error&&(t.__isError=!0,t.message=t.message||e.message,t.name=t.name||e.name),t}function a(n){if(!w)return(new e).reject(new Error("plugin not connected"));n.id=String(h++);var r=new e;v[n.id]=r,r.then(null,function(e){p&&e instanceof Error&&"Cancel"===e.name&&S({requestId:n.id,method:"cancel",params:e.message?[e.message]:[]})});var o=Object.prototype.toString;return n.params.forEach(function(e,i){if("[object Object]"===o.call(e)&&!(e instanceof t)){var s,a;for(s in e)"[object Function]"===o.call(e[s])&&(a=a||[],a.push(s));if(a){var u=d++;y[u]=e;var l=function(){delete y[u]};r.then(l,l),n.params[i]=new t(u,a)}}}),S(n),r.promise}function u(e,t){e||0===e?S({id:e,result:null,error:t}):console.log(t)}function l(e,t,n,r){r.forEach(function(e,t){if(e&&"undefined"!=typeof e.__objectId){var n={};e.__methods.forEach(function(t){n[t]=function(){return a({objectId:e.__objectId,method:t,params:Array.prototype.slice.call(arguments)})}}),r[t]=n}});var o="undefined"==typeof e?null:{id:e,result:null,error:null};try{var i=n.apply(t,r);if(!o)return;i&&"function"==typeof i.then?(m[e]=i,i.then(function(t){delete m[e],o.result=t,S(o)},function(t){m[e]&&(delete m[e],o.error=s(t),S(o))},function(){S({responseId:e,method:"progress",params:Array.prototype.slice.call(arguments)})})):(o.result=i,S(o))}catch(u){o&&(o.error=s(u),S(o))}}function c(e){if(e.source===w||"undefined"==typeof window){var t="string"!=typeof e.data?e.data:JSON.parse(e.data);try{if(t.method){var n=t.method,r=t.params||[];if("serviceId"in t){var o=b[t.serviceId];o||u(t.id,"service not found"),o=o.implementation,n in o?l(t.id,o,o[n],r):u(t.id,"method not found")}else if("objectId"in t){var i=y[t.objectId];i||u(t.id,"object not found"),!n in i?l(t.id,i,i[n],r):u(t.id,"method not found")}else if("requestId"in t){var s=m[t.requestId];s&&"cancel"===n&&s.cancel&&s.cancel.apply(s,r)}else{if(!("responseId"in t))throw new Error("Bad method: "+t.method);var a=v[t.responseId];a&&"progress"===n&&a.progress&&a.progress.apply(a,r)}}else{var c=v[String(t.id)];delete v[String(t.id)],t.error?c.reject(t.error):c.resolve(t.result)}}catch(f){console.log("Plugin._messageHandler "+f)}}}var f=n,p=!1,h=0,d=0,g=0,m={},v={},y={},b={},w=null;"undefined"==typeof window?w=self:window!==window.parent?w=window.parent:null!==window.opener&&(w=window.opener);var S=r;r({method:"loading"}),this.updateHeaders=function(e){if(p)throw new Error("Cannot update headers. Plugin Provider is connected");f=e},this.registerService=function(e,t,n){if(p)throw new Error("Cannot register service. Plugin Provider is connected");"string"==typeof e?e=[e]:Array.isArray(e)||(e=[]);var r=null,o=[];for(r in t)"function"==typeof t[r]&&o.push(r);b[g++]={names:e,methods:o,implementation:t,properties:n||{},listeners:{}}},this.registerServiceProvider=this.registerService,this.connect=function(e,t){if(p)return void(e&&e());if(!w)return void(t&&t("No valid plugin target"));addEventListener("message",c,!1);var n={method:"plugin",params:[o()]};r(n),p=!0,e&&e()},this.disconnect=function(){p&&(removeEventListener("message",c),w=null,p=!1)}}return n}),define("orion/i18nUtil",["require","orion/Deferred"],function(){function e(e){var t=/\$\{([^\}]+)\}/g,n=arguments;return 2===n.length&&n[1]&&"object"==typeof n[1]?e.replace(t,function(e,t){return n[1][t]}):e.replace(t,function(e,t){return n[(t<<0)+1]})}return{formatMessage:e}}),define("orion/xsrfUtils",[],function(){function e(){var e,t,n,o=document.cookie.split(";");for(e=0;e<o.length;e++)if(t=o[e].substr(0,o[e].indexOf("=")).trim(),n=o[e].substr(o[e].indexOf("=")+1).trim(),t==r)return n}function t(t){var n=e();n&&(t[r]=n)}function n(t){var n=e();n&&t.setRequestHeader(r,n)}var r="x-csrf-token";return{XSRF_TOKEN:r,getCSRFToken:e,setNonceHeader:t,addCSRFNonce:n}}),function(){function e(e){if("string"!=typeof e)throw new TypeError}function t(e){return e?e.split("&"):[]}function n(e){return 0===e.length?"":e.join("&")}function r(e){var t=/([^=]*)(?:=?)(.*)/.exec(e),n=t[1]?decodeURIComponent(t[1]):"",r=t[2]?decodeURIComponent(t[2]):"";return[n,r]}function o(e){var t=encodeURIComponent(e[0]);return e[1]&&(t+="="+encodeURIComponent(e[1])),t}function i(e,n){var o="",i=[],s=0;return{next:function(){if(o!==e.query&&(o=e.query,i=t(o)),s<i.length){var a=r(i[s++]);switch(n){case"keys":return a[0];case"values":return a[1];case"keys+values":return[a[0],a[1]];default:throw new TypeError}}throw x}}}function s(e){Object.defineProperty(this,"_url",{get:function(){return e._url}})}function a(e,t){if(!e.scheme&&t&&(e.scheme=t.scheme,!e.host&&t.host&&(e.userinfo=t.userinfo,e.host=t.host,e.port=t.port,e.pathRelative=!0)),e.pathRelative)if(e.path){if("/"!==e.path[0]){var n=/^(.*\/)[^\/]*$/.exec(t.path)[1]||"/";e.path=n+e.path}}else e.path=t.path}function u(e){return e.toLowerCase()}function l(e){return e?/[1-9]\d*$/.exec(e)[0]:""}function c(e){var t=[];return e.split("/").forEach(function(e){".."===e?t.pop():"."!==e&&t.push(e)}),t.join("/")}function f(e){e.scheme&&(e.scheme=u(e.scheme)),e.port&&(e.port=l(e.port)),e.host&&e.path&&(e.path=c(e.path))}function p(e){return e.replace(/\s/g,function(e){return"%"+e.charCodeAt(0).toString(16)})}function h(e,t){if("string"!=typeof e)throw new TypeError;e=p(e);var n=y.exec(e);if(!n)return null;var r={};if(r.scheme=n[1]||"",r.scheme&&!S.test(r.scheme))return null;var o=n[2];if(o){var i=b.exec(o);if(r.userinfo=i[1],r.host=i[2],r.port=i[3],r.port&&!_.test(r.port))return null}return r.path=n[3],r.query=n[4],r.fragment=n[5],a(r,t),f(r),r}function d(e){var t=e.scheme?e.scheme+":":"";return e.host&&(t+="//",e.userinfo&&(t+=e.userinfo+"@"),t+=e.host,e.port&&(t+=":"+e.port)),t+=e.path,e.query&&(t+="?"+e.query),e.fragment&&(t+="#"+e.fragment),t}function g(e,t){var n;if(t){if(t=t.href||t,n=h(t),!n||!n.scheme)throw new SyntaxError;Object.defineProperty(this,"_baseURL",{value:n})}var r=h(e,n);if(!r)throw new SyntaxError;Object.defineProperty(this,"_input",{value:e,writable:!0}),Object.defineProperty(this,"_url",{value:r,writable:!0});var o=new s(this);Object.defineProperty(this,"query",{get:function(){return this._url?o:null},enumerable:!0})}try{var m;if("function"==typeof window.URL&&0!==window.URL.length&&"http:"===(m=new window.URL("http://www.w3.org?q")).protocol&&m.query)return}catch(v){}var y=/^(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?$/,b=/^(?:(.*)@)?(\[[^\]]*\]|[^:]*)(?::(.*))?$/,w=/^\S*$/,S=/^([a-zA-Z](?:[a-zA-Z0-9+-.])*)$/,_=/^\d*$/,O=/^(\[[^\]\/?#\s]*\]|[^:\/?#\s]*)$/,P=/^(\[[^\]\/?#\s]*\]|[^:\/?#\s]*)(?::(\d*))?$/,T=/^([^?#\s]*)$/,E=/^([^\s]*)$/,k=w,j=/([^:]*):?(.*)/,x="undefined"!=typeof StopIteration?StopIteration:new Error("Stop Iteration"),L={"ftp:":"21","gopher:":"70","http:":"80","https:":"443","ws:":"80","wss:":"443"};Object.defineProperties(s.prototype,{get:{value:function(n){e(n);var o,i=t(this._url.query);return i.some(function(e){var t=r(e);return t[0]===n?(o=t[1],!0):void 0}),o},enumerable:!0},set:{value:function(i,s){e(i),e(s);var a=t(this._url.query),u=a.some(function(e,t){var n=r(e);return n[0]===i?(n[1]=s,a[t]=o(n),!0):void 0});u||a.push(o([i,s])),this._url.query=n(a)},enumerable:!0},has:{value:function(n){e(n);var o=t(this._url.query);return o.some(function(e){var t=r(e);return t[0]===n?!0:void 0})},enumerable:!0},"delete":{value:function(o){e(o);var i=t(this._url.query),s=i.filter(function(e){var t=r(e);return t[0]!==o});return s.length!==i.length?(this._url.query=n(s),!0):!1},enumerable:!0},clear:{value:function(){this._url.query=""},enumerable:!0},forEach:{value:function(e,t){if("function"!=typeof e)throw new TypeError;var n=i(this._url,"keys+values");try{for(;;){var r=n.next();e.call(t,r[1],r[0],this)}}catch(o){if(o!==x)throw o}},enumerable:!0},keys:{value:function(){return i(this._url,"keys")},enumerable:!0},values:{value:function(){return i(this._url,"values")},enumerable:!0},items:{value:function(){return i(this._url,"keys+values")}},size:{get:function(){return t(this._url.query).length},enumerable:!0},getAll:{value:function(n){e(n);var o=[],i=t(this._url.query);return i.forEach(function(e){var t=r(e);t[0]===n&&o.push(t[1])}),o},enumerable:!0},append:{value:function(r,i){e(r),e(i);var s=t(this._url.query);s.push(o([r,i])),this._url.query=n(s)},enumerable:!0}}),Object.defineProperties(g.prototype,{href:{get:function(){return this._url?d(this._url):this._input},set:function(t){e(t),this._input=t,this._url=h(this._input,this._baseURL)},enumerable:!0},origin:{get:function(){return this._url&&this._url.host?this.protocol+"//"+this.host:""},enumerable:!0},protocol:{get:function(){return this._url?this._url.scheme+":":":"},set:function(t){if(e(t),this._url){var n=":"===t.slice(-1)?t.substring(0,t.length-1):t;(""===n||S.test(n))&&(this._url.scheme=u(n))}},enumerable:!0},_userinfo:{get:function(){return this._url?this._url.userinfo:""},set:function(t){e(t),this._url&&(this._url.userinfo=t)}},username:{get:function(){if(!this._url)return"";var e=j.exec(this._userinfo),t=decodeURIComponent(e[1]||"");return t},set:function(t){if(e(t),this._url){var n=j.exec(this._userinfo),r=[encodeURIComponent(t||"")];n[2]&&r.push(n[2]),this._userinfo=r.join(":")}},enumerable:!0},password:{get:function(){if(!this._url)return"";var e=j.exec(this._userinfo),t=decodeURIComponent(e[2]||"");return t},set:function(t){if(e(t),this._url){var n=j.exec(this._userinfo),r=[n[1]||""];t&&r.push(encodeURIComponent(t)),this._userinfo=r.join(":")}},enumerable:!0},host:{get:function(){var e="";return this._url&&this._url.host&&(e+=this._url.host,this._url.port&&(e+=":"+this._url.port)),e},set:function(t){if(e(t),this._url){var n=P.exec(t);n&&(this._url.host=n[1],this._url.port=l(n[2]))}},enumerable:!0},hostname:{get:function(){return this._url?this._url.host:""},set:function(t){if(e(t),this._url){var n=O.exec(t);n&&(this._url.host=t)}},enumerable:!0},port:{get:function(){var e=this._url?this._url.port||"":"";return e&&e===L[this.protocol]&&(e=""),e},set:function(t){if(e(t),this._url){var n=_.exec(t);n&&(this._url.port=l(t))}},enumerable:!0},pathname:{get:function(){return this._url?this._url.path:""},set:function(t){if(e(t),this._url){var n=T.exec(t);n&&(this._url.host&&t&&"/"!==t[0]&&(t="/"+t),this._url.path=t?c(t):"")}},enumerable:!0},search:{get:function(){return this._url&&this._url.query?"?"+this._url.query:""},set:function(t){if(e(t),this._url){t&&"?"===t[0]&&(t=t.substring(1));var n=E.exec(t);n&&(this._url.query=t)}},enumerable:!0},hash:{get:function(){return this._url&&this._url.fragment?"#"+this._url.fragment:""},set:function(t){if(e(t),this._url){t&&"#"===t[0]&&(t=t.substring(1));var n=k.exec(t);n&&(this._url.fragment=t)}},enumerable:!0}});var C=window.URL||window.webkitURL;C&&C.createObjectURL&&(Object.defineProperty(g,"createObjectURL",{value:C.createObjectURL.bind(C),enumerable:!1}),Object.defineProperty(g,"revokeObjectURL",{value:C.revokeObjectURL.bind(C),enumerable:!1})),window.URL=g}(),define("orion/URL-shim",function(){}),define("orion/xhr",["orion/Deferred","orion/xsrfUtils","orion/URL-shim"],function(e,t){function n(e,t,n,r){var o,i="undefined"!=typeof n.response?n.response:n.responseText,s="string"==typeof i?i:null;try{o=n.status}catch(a){o=0}var u={args:t,response:i,responseText:s,status:o,url:e,xhr:n};return"undefined"!=typeof r&&(u.error=r),u}function r(e){return new URL(location.href).origin===new URL(e,location.href).origin}function o(o,i,s){s=s||{};var a=arguments.length>3&&arguments[3]?arguments[3]:new XMLHttpRequest,u=new e,l=s.headers||{};r(i)&&t.setNonceHeader(l);var c,f=s.log||!1;"undefined"==typeof l["X-Requested-With"]&&(l["X-Requested-With"]="XMLHttpRequest"),"undefined"==typeof s.data||"POST"!==o&&"PUT"!==o||(c=s.data);var p=!1,h=!1;u.promise.then(void 0,function(e){p=!0,!h&&e instanceof Error&&"Cancel"===e.name&&a.abort()}),a.onabort=function(){if(h=!0,!p){var e=new Error("Cancel");e.name="Cancel",u.reject(e)}},a.onload=function(){var e=n(i,s,a);200<=a.status&&a.status<400?u.resolve(e):(u.reject(e),f&&"undefined"!=typeof console&&console.log(new Error(a.statusText)))},a.onerror=function(){var e=n(i,s,a);u.reject(e),f&&"undefined"!=typeof console&&console.log(new Error(a.statusText))},a.onprogress=function(e){e.xhr=a,u.progress(e)};try{if(a.open(o,i,!0),"string"==typeof s.responseType&&(a.responseType=s.responseType),"number"==typeof s.timeout)if("number"==typeof a.timeout)a.timeout=s.timeout,a.addEventListener("timeout",function(){u.reject(n(i,s,a,"Timeout exceeded"))});else{var d=setTimeout(function(){u.reject(n(i,s,a,"Timeout exceeded"))},s.timeout);u.promise.then(clearTimeout.bind(null,d),clearTimeout.bind(null,d))}Object.keys(l).forEach(function(e){a.setRequestHeader(e,l[e])}),a.send(c||null)}catch(g){u.reject(n(i,s,a,g))}return u.promise}return o}),define("orion/regex",[],function(){function e(e){return e.replace(/([\\$\^*\/+?\.\(\)|{}\[\]])/g,"\\$&")}function t(e){var t=/^\s*\/(.+)\/([gim]{0,3})\s*$/.exec(e);return t?{pattern:t[1],flags:t[2]}:null}return{escape:e,parse:t}}),define("plugins/site/siteServiceImpl",["require","orion/i18nUtil","orion/xhr","orion/regex"],function(e,t,n,r){function o(e){var t=document.createElement("a");return t.href=e,t.href}function i(){var t=e.toUrl("._"),n=o(t);return n.substring(0,n.length-2)}function s(e){return-1!==e.indexOf(":")?e.substring(e.indexOf(window.location.host)+window.location.host.length):e}function a(e,t,n){return e.HostingStatus.URL+("/"!==t[0]?"/":"")+t+(n.Directory?"/":"")}function u(e){return new RegExp("^/").test(e)}function l(e){return g.href=e,g.href}function c(e){return e&&"object"==typeof e&&Object.keys(e).forEach(function(t){var n=e[t];-1!==t.indexOf("Location")?e[t]=l(n):c(n)}),e}function f(e,t){for(var n,r=e.split("/"),o=r[1],i=0;i<t.length;i++){var s=t[i];if(s.Id===o){r[1]=s.Name,n=r.join("/");break}}return n}function p(e,t,r){return r&&"undefined"!=typeof r.data&&(r.data=JSON.stringify(r.data)),n.apply(null,Array.prototype.slice.call(arguments)).then(function(e){return JSON.parse(e.response||null)})}function h(e){this.projects={},this.getProjects=function(t){var n={"Orion-Version":"1"};return this.projects[t]||(this.projects[t]=p("GET",e,{headers:n}).then(function(e){for(var r,o=e.Workspaces,i=0;i<o.length&&(r=o[i],r.Id!==t);i++);return p("GET",r.Location,{headers:n}).then(function(e){return e.Children||[]})})),this.projects[t]}}function d(e,n,o){this.filePrefix=e,this.cache=new h(n),this.makeAbsolute=n&&-1!==n.indexOf("://"),this.selfHostingRules=o;var a=o.Rules,u=o.Types.File,l=o.Types.API;this._generateSelfHostingMappings=function(e){var n="http://localhost"+s(i());return a.map(function(r){var o;return o=r.type===u?t.formatMessage.apply(t,[r.targetPattern].concat(e)):t.formatMessage(r.targetPattern,n),{Source:r.source,Target:o}})},this._matchesSelfHostingTemplate=function(e,t){var n=/(\$\{[^}]+?\})/,o=r.escape("http://localhost")+"(:\\d+)?"+r.escape(s(i()));return a.every(function(i){return t.Mappings.some(function(t){if(t.Source===i.source){var s;i.type===u?s=r.escape(e)+".*?":i.type===l&&(s=o);var a=[];return i.targetPattern.split(n).forEach(function(e){a.push(n.test(e)?s:r.escape(e))}),new RegExp(a.join("")).test(t.Target)}return!1})})}}var g=document.createElement("a");return d.prototype={getSiteConfigurations:function(){var t=e.toUrl("site._");return t=t.substring(0,t.length-2),p("GET",t,{headers:{"Orion-Version":"1"},timeout:15e3}).then(function(e){return e.SiteConfigurations}).then(function(e){return this.makeAbsolute&&c(e),e}.bind(this))},loadSiteConfiguration:function(e){return p("GET",e,{headers:{"Orion-Version":"1"},timeout:15e3}).then(function(e){return this.makeAbsolute&&c(e),e}.bind(this))},createSiteConfiguration:function(t,n,r,o,i){function s(e){return e.replace(/ /g,"-").replace(/[^A-Za-z0-9-_]/g,"").toLowerCase()}var a={Name:t,Workspace:n,HostHint:s(t)};r&&(a.Mappings=r),o&&(a.HostHint=o),i&&(a.HostingStatus=i);var u=e.toUrl("site._");return u=u.substring(0,u.length-2),p("POST",u,{data:a,headers:{"Content-Type":"application/json; charset=utf-8","Orion-Version":"1"},timeout:15e3}).then(function(e){return this.makeAbsolute&&c(e),e}.bind(this))},updateSiteConfiguration:function(e,t){return p("PUT",e,{data:t,headers:{"Content-Type":"application/json; charset=utf-8","Orion-Version":"1"},timeout:15e3}).then(function(e){return this.makeAbsolute&&c(e),e}.bind(this))},deleteSiteConfiguration:function(e){return p("DELETE",e,{headers:{"Orion-Version":"1"},timeout:15e3}).then(function(e){return this.makeAbsolute&&c(e),e}.bind(this))},toInternalForm:function(e){var t,n=s(this.filePrefix),r=s(e);return 0===r.indexOf(n)&&(t=r.substring(n.length)),"/"===t[t.length-1]&&(t=t.substring(0,t.length-1)),t},toFileLocation:function(t){function n(e){return e.filter(function(e){return""!==e})}var r=e.toUrl(this.filePrefix+t+"._");r=r.substring(0,r.length-2);var i=t.split("/");return 1===n(i).length&&(r+="/"),s(o(r))},getMappingObject:function(e,t,n){var r=this.toInternalForm(t);return this.cache.getProjects(e.Workspace).then(function(e){var t=f(r,e);return{Source:n,Target:r,FriendlyPath:t||n}})},getMappingProposals:function(e){var t=this;return this.cache.getProjects(e.Workspace).then(function(e){return e.map(function(e){return{Source:"/"+e.Name,Target:t.toInternalForm(e.Location),FriendlyPath:"/"+e.Name}})})},updateMappingsDisplayStrings:function(e){return this.cache.getProjects(e.Workspace).then(function(t){for(var n=e.Mappings,r=0;r<n.length;r++){var o=n[r];u(o.Target)&&(o.FriendlyPath=f(o.Target,t))}return e})},parseInternalForm:function(e,t){return u(t)?this.cache.getProjects(e.Workspace).then(function(e){for(var n=t.split("/"),r=0;r<e.length;r++){var o=e[r];if(n[1]===o.Name)return n[1]=o.Id,n.join("/")}}):null},isSelfHostingSite:function(e){var t=this;return this.cache.getProjects(e.Workspace).then(function(n){return n.some(function(n){var r=t.toInternalForm(n.Location);return t._matchesSelfHostingTemplate(r,e)})})},convertToSelfHosting:function(e,t){var n=t.map(this.toInternalForm.bind(this)),r=this._generateSelfHostingMappings(n);return e.Mappings=r,e},getURLOnSite:function(e,t){var n=e.Mappings,r=this.toInternalForm(t.Location);if(!n)return null;for(var o=0;o<n.length;o++){var i=n[o];if(i.Target===r)return a(e,i.Source,t)}return null}},{SiteImpl:d}}),define("plugins/site/selfHostingRules",[],function(){var e=0,t=1,n=[{type:e,source:"/",targetPattern:"${0}/bundles/org.eclipse.orion.client.ui/web/index.html"},{type:e,source:"/",targetPattern:"${0}/bundles/org.eclipse.orion.client.ui/web"},{type:e,source:"/",targetPattern:"${0}/bundles/org.eclipse.orion.client.help/web"},{type:e,source:"/",targetPattern:"${0}/bundles/org.eclipse.orion.client.users/web"},{type:e,source:"/",targetPattern:"${0}/bundles/org.eclipse.orion.client.core/web"},{type:e,source:"/",targetPattern:"${0}/bundles/org.eclipse.orion.client.editor/web"},{type:e,source:"/",targetPattern:"${0}/bundles/org.eclipse.orion.client.cf/web"},{type:e,source:"/",targetPattern:"${0}/bundles/org.eclipse.orion.client.git/web"},{type:e,source:"/",targetPattern:"${0}/bundles/org.eclipse.orion.client.javascript/web"},{type:e,source:"/",targetPattern:"${0}/bundles/org.eclipse.orion.client.webtools/web"},{type:t,source:"/file",targetPattern:"${0}file"},{type:t,source:"/prefs",targetPattern:"${0}prefs"},{type:t,source:"/workspace",targetPattern:"${0}workspace"},{type:t,source:"/users",targetPattern:"${0}users"},{type:t,source:"/authenticationPlugin.html",targetPattern:"${0}authenticationPlugin.html"},{type:t,source:"/login",targetPattern:"${0}login"},{type:t,source:"/loginstatic",targetPattern:"${0}loginstatic"},{type:t,source:"/useremailconfirmation",targetPattern:"${0}useremailconfirmation"},{type:t,source:"/site",targetPattern:"${0}site"},{type:t,source:"/gitapi",targetPattern:"${0}gitapi"},{type:t,source:"/xfer",targetPattern:"${0}xfer"},{type:t,source:"/filesearch",targetPattern:"${0}filesearch"},{type:t,source:"/index.jsp",targetPattern:"${0}index.jsp"},{type:t,source:"/plugins/git",targetPattern:"${0}plugins/git"},{type:t,source:"/plugins/user",targetPattern:"${0}plugins/user"},{type:t,source:"/logout",targetPattern:"${0}logout"},{type:t,source:"/task",targetPattern:"${0}task"},{type:t,source:"/cfapi",targetPattern:"${0}cfapi"},{type:t,source:"/metrics",targetPattern:"${0}metrics"}];return{Rules:n,Types:{File:e,API:t}}}),function(){function e(e,t,n,r,o,i){t[e]&&(n.push(e),(t[e]===!0||1===t[e])&&r.push(o+e+"/"+i))}function t(e,t,n,r,o){var i=r+t+"/"+o;require._fileExists(e.toUrl(i+".js"))&&n.push(i)}function n(e,t,r){var o;for(o in t)!t.hasOwnProperty(o)||e.hasOwnProperty(o)&&!r?"object"==typeof t[o]&&(!e[o]&&t[o]&&(e[o]={}),n(e[o],t[o],r)):e[o]=t[o]}var r=/(^.*(^|\/)nls(\/|$))([^\/]*)\/?([^\/]*)/;define("i18n",["module"],function(o){var i=o.config?o.config():{};return{version:"2.0.4",load:function(o,s,a,u){u=u||{},u.locale&&(i.locale=u.locale);var l,c,f,p=r.exec(o),h=p[1],d=p[4],g=p[5],m=d.split("-"),v=[],y={},b="";if(p[5]?(h=p[1],l=h+g):(l=o,g=p[4],d=i.locale,d||(d=i.locale="undefined"==typeof navigator?"root":(navigator.language||navigator.userLanguage||"root").toLowerCase()),m=d.split("-")),u.isBuild){for(v.push(l),t(s,"root",v,h,g),c=0;c<m.length;c++)f=m[c],b+=(b?"-":"")+f,t(s,b,v,h,g);if(u.locales){var w,S;for(w=0;w<u.locales.length;w++)for(d=u.locales[w],m=d.split("-"),b="",S=0;S<m.length;S++)f=m[S],b+=(b?"-":"")+f,t(s,b,v,h,g)}s(v,function(){a()})}else s([l],function(t){var r,o=[];for(e("root",t,o,v,h,g),c=0;c<m.length;c++)r=m[c],b+=(b?"-":"")+r,e(b,t,o,v,h,g);s(v,function(){var e,r,i;for(e=o.length-1;e>-1&&o[e];e--)i=o[e],r=t[i],(r===!0||1===r)&&(r=s(h+i+"/"+g)),n(y,r);a(y)})})}}})}(),define("orion/nls/messages",{root:!0}),define("orion/nls/root/messages",{Navigator:"Navigator",Sites:"Sites",Shell:"Shell",ShellLinkWorkspace:"Shell","Get Plugins":"Get Plugins",Global:"Global",Editor:"Editor",EditorRelatedLink:"Show Current Folder",EditorRelatedLinkParent:"Show Enclosing Folder",EditorLinkWorkspace:"Edit",EditorRelatedLinkProj:"Show Project","Filter bindings":"Filter bindings","Orion Editor":"Orion Editor","Orion Image Viewer":"Orion Image Viewer","Orion Markdown Editor":"Orion Markdown Editor","Orion Markdown Viewer":"Orion Markdown Viewer","Orion JSON Editor":"Orion JSON Editor","View on Site":"View on Site","View this file or folder on a web site hosted by Orion":"View this file or folder on a web site hosted by Orion.",ShowAllKeyBindings:"Show a list of all the keybindings on this page","Show Keys":"Show Keys",HideShowBannerFooter:"Hide or show the page banner and footer","Toggle banner and footer":"Toggle banner and footer",ChooseFileOpenEditor:"Choose a file by name and open an editor on it",FindFile:"Find File Named...","System Configuration Details":"System Configuration Details","System Config Tooltip":"Go to the System Configuration Details page","Background Operations":"Background Operations","Background Operations Tooltip":"Go to the Background Operations page","Operation status is unknown":"Operation status is unknown","Unknown item":"Unknown item",NoSearchAvailableErr:"Can't search: no search service is available",Related:"Related",Options:"Options",FAQ:"FAQ","Report a Bug":"Bugs","Privacy Policy":"Privacy","Terms of Use":"Terms","Copyright Agent":"Copyright","Orion Logo":"Orion Logo","Orion is in Beta. Please try it out but BEWARE your data may be lost.":"@buildLabel@","LOG: ":"LOG: ",View:"View","no parent":"no parent","no tree model":"no tree model","no renderer":"no renderer","could not find table row ":"could not find table row ",Operations:"Operations","Operations running":"Operations running",SomeOpWarning:"Some operations finished with warning",SomeOpErr:"Some operations finished with error","no service registry":"no service registry",Tasks:"Tasks",Close:"Close","Expand all":"Expand all","Collapse all":"Collapse all",Search:"Search","Advanced search":"Advanced search",Submit:"Submit",More:"More","Recent searches":"Recent searches","Regular expression":"Regular expression","Search options":"Search options","Global search":"Global search","Orion Home":"Orion Home","Close notification":"Close notification",OpPressSpaceMsg:"Operations - Press spacebar to show current operations","Toggle side panel":"Toggle side panel","Open or close the side panel":"Open or close the side panel",Projects:"Projects","Toggle Sidebar":"Toggle Sidebar","Sample HTML5 Site":"Sample HTML5 Site","Generate an HTML5 'Hello World' website, including JavaScript, HTML, and CSS files.":"Generate an HTML5 'Hello World' website, including JavaScript, HTML, and CSS files.","Sample Orion Plugin":"Sample Orion Plugin","Generate a sample plugin for integrating with Orion.":"Generate a sample plugin for integrating with Orion.",Browser:"Web Browser",OutlineProgress:"Getting outline for ${0} from ${1}",outlineTimeout:"Outline service timed out. Try reloading the page and opening the outline again.",UnknownError:"An unknown error occurred.",UnknownWarning:"An unknown warning occurred.",Filter:"Filter (* = any string, ? = any character)",TemplateExplorerLabel:"Templates",OpenTemplateExplorer:"Open Template Explorer",Edit:"Edit",CentralNavTooltip:"Toggle Navigation Menu","Wrote: ${0}":"Wrote: ${0}",GenerateHTML:"Generate HTML file",GenerateHTMLTooltip:"Write an HTML file generated from the current Markdown editor content","alt text":"alt text",blockquote:"blockquote",code:"code","code (block)":"code (block)","code (span)":"code (span)",emphasis:"emphasis","fenced code (${0})":"fenced code (${0})","header (${0})":"header (${0})","horizontal rule":"horizontal rule",label:"label","link (auto)":"link (auto)","link (image)":"link (image)","link (inline)":"link (inline)","link label":"link label","link label (optional)":"link label (optional)","link (ref)":"link (ref)","list item (bullet)":"list item (bullet)","list item (numbered)":"list item (numbered)","strikethrough (${0})":"strikethrough (${0})",strong:"strong","table (${0})":"table (${0})",text:"text","title (optional)":"title (optional)",url:"url",TogglePaneOrientationTooltip:"Toggle split pane orientation",WarningHeaderTooDeep:"Header level cannot exceed 6",WarningUnorderedListItem:"Unordered list item within ordered list",WarningOrderedListItem:"Ordered list item within unordered list",WarningOrderedListShouldStartAt1:"The first item in an ordered list should have index 1",WarningLinkHasNoText:"Link has no text",WarningLinkHasNoURL:"Link has no URL",WarningUndefinedLinkId:"Undefined link ID: ${0}",PageTitleFormat:"${0} - ${1}",KeyCTRL:"Ctrl",KeySHIFT:"Shift",KeyALT:"Alt",KeyBKSPC:"Backspace",KeyDEL:"Del",KeyEND:"End",KeyENTER:"Enter",KeyESCAPE:"Esc",KeyHOME:"Home",KeyINSERT:"Ins",KeyPAGEDOWN:"Page Down",KeyPAGEUP:"Page Up",KeySPACE:"Space",KeyTAB:"Tab"}),define("plugins/site/sitePlugin",["orion/plugin","plugins/site/siteServiceImpl","plugins/site/selfHostingRules","i18n!orion/nls/messages"],function(e,t,n,r){function o(e){var t=document.createElement("a");return t.href=e,t.href}function i(e){e=o(e);try{if(window.location.host===parent.location.host&&window.location.protocol===parent.location.protocol)return e.substring(parent.location.href.indexOf(parent.location.host)+parent.location.host.length)}catch(t){}return e}function s(e){return[{source:"Location|Directory"},{source:"Location",match:"^"+e}]}var a=i("../../site"),u=i("../../file"),l=i("../../workspace"),c=document.createElement("a");c.href="../../mixloginstatic/LoginWindow.html";var f=c.href,p={name:"Orion Site Service",version:"1.0",description:"This plugin provides virtual site support for hosting client web applications from your Orion workspace.",login:f},h=new e(p),d=document.createElement("a");d.href="/",h.registerService("orion.page.link.category",null,{id:"sites",name:r.Sites,nls:"orion/nls/messages",imageClass:"core-sprite-sites",order:50,uriTemplate:"{+OrionHome}/sites/"}),h.registerService("orion.page.link",null,{name:r.Sites,id:"orion.sites",nls:"orion/nls/messages",category:"sites",order:1e3,uriTemplate:"{+OrionHome}/sites/sites.html"}),h.registerService("orion.page.link",null,{name:r.Sites,id:"orion.sites.2",nls:"orion/nls/messages",category:"sites",order:10,uriTemplate:"{+OrionHome}/sites/sites.html"}),h.registerService("orion.navigate.command",null,{id:"orion.site."+d.hostname+".viewon",name:r["View on Site"],tooltip:r["View this file or folder on a web site hosted by Orion"],nls:"orion/nls/messages",forceSingleItem:!0,category:"sites",validationProperties:s(u),uriTemplate:"{+OrionHome}/sites/view.html#,file={,Location}"}),h.registerService("orion.page.link.related",null,{id:"orion.site."+d.hostname+".viewon",name:r["View on Site"],tooltip:r["View this file or folder on a web site hosted by Orion"],nls:"orion/nls/messages",category:"sites",validationProperties:s(u),uriTemplate:"{+OrionHome}/sites/view.html#,file={,Location}"}),h.registerService("orion.site",new t.SiteImpl(u,l,n),{id:"orion.site."+d.hostname,name:"Orion Sites at "+d.hostname,pattern:a,filePattern:u,canSelfHost:!0,selfHostingConfig:{folders:[{name:"org.eclipse.orion.client",label:r.orionClientLabel}]}}),h.connect()
});