!function(e,t){"function"==typeof define&&define.amd?define("orion/Deferred",t):"object"==typeof exports?module.exports=t():(e.orion=e.orion||{},e.orion.Deferred=t())}(this,function(){function e(){for(var e;e=i.shift();)e();s=!1}function t(e){i.push(e),s||(s=!0,u())}function n(e){return function(t){e(t)}}function r(e,t,r){try{var o=e(t),i=o&&("object"==typeof o||"function"==typeof o)&&o.then;if("function"==typeof i)if(o===r.promise)r.reject(new TypeError);else{var s=o.cancel;"function"==typeof s?r._parentCancel=s.bind(o):delete r._parentCancel,i.call(o,n(r.resolve),n(r.reject),n(r.progress))}else r.resolve(o)}catch(u){r.reject(u)}}function o(){function e(){for(var e;e=c.shift();){var t=e.deferred,n="fulfilled"===a?"resolve":"reject",o=e[n];"function"==typeof o?r(o,u,t):t[n](u)}}function n(n){delete f._parentCancel,a="rejected",u=n,c.length&&t(e)}function i(r){function s(e){return function(t){a&&"assumed"!==a||e(t)}}delete f._parentCancel;try{var l=r&&("object"==typeof r||"function"==typeof r)&&r.then;if("function"==typeof l)if(r===f)n(new TypeError);else{a="assumed";var d=r&&r.cancel;if("function"!=typeof d){var p=new o;r=p.promise;try{l(p.resolve,p.reject,p.progress)}catch(h){p.reject(h)}d=r.cancel,l=r.then}u=r,l.call(r,s(i),s(n)),f._parentCancel=d.bind(r)}else a="fulfilled",u=r,c.length&&t(e)}catch(v){s(n)(v)}}function s(){var e=f._parentCancel;if(e)delete f._parentCancel,e();else if(!a){var t=new Error("Cancel");t.name="Cancel",n(t)}}var u,a,c=[],f=this;this.resolve=function(e){return a||i(e),f},this.reject=function(e){return a||n(e),f},this.progress=function(e){return a||c.forEach(function(t){if(t.progress)try{t.progress(e)}catch(n){}}),f.promise},this.cancel=function(){return f._parentCancel?setTimeout(s,0):s(),f},this.then=function(n,r,i){var s=new o;return s._parentCancel=f.promise.cancel,c.push({resolve:n,reject:r,progress:i,deferred:s}),("fulfilled"===a||"rejected"===a)&&t(e),s.promise},this.promise={then:f.then,cancel:f.cancel}}var i=[],s=!1,u=function(){if("undefined"!=typeof process&&"function"==typeof process.nextTick){var t=process.nextTick;return function(){t(e)}}if("function"==typeof MutationObserver){var n=document.createElement("div"),r=new MutationObserver(e);return r.observe(n,{attributes:!0}),function(){n.setAttribute("class","_tick")}}return function(){setTimeout(e,0)}}();return o.all=function(e,t){function n(e,t){u||(s[e]=t,0===--i&&a.resolve(s))}function r(e,r){if(!u){if(t)try{return void n(e,t(r))}catch(o){r=o}a.reject(r)}}var i=e.length,s=[],u=!1,a=new o;return a.then(void 0,function(){u=!0,e.forEach(function(e){e.cancel&&e.cancel()})}),0===i?a.resolve(s):e.forEach(function(e,t){e.then(n.bind(void 0,t),r.bind(void 0,t))}),a.promise},o.when=function(e,t,n,r){var i,s;return e&&"function"==typeof e.then?i=e:(s=new o,s.resolve(e),i=s.promise),i.then(t,n,r)},o}),function(e,t){"function"==typeof define&&define.amd?define("orion/plugin",["orion/Deferred"],t):"object"==typeof exports?module.exports=t(require("orion/Deferred")):(e.orion=e.orion||{},e.orion.PluginProvider=t(e.orion.Deferred))}(this,function(e){function t(e,t){this.__objectId=e,this.__methods=t}function n(n){function r(e){_&&("undefined"==typeof ArrayBuffer&&(e=JSON.stringify(e)),_===self?_.postMessage(e):_.postMessage(e,"*"))}function o(){var e=[];return Object.keys(w).forEach(function(t){var n=w[t];e.push({serviceId:t,names:n.names,methods:n.methods,properties:n.properties})}),{headers:l||{},services:e}}function i(e,t){if(t&&t instanceof XMLHttpRequest){var n,r;try{n=t.status,r=t.statusText}catch(o){n=0,r=""}return{status:n||0,statusText:r}}return t}function s(e){var t=e?JSON.parse(JSON.stringify(e,i)):e;return e instanceof Error&&(t.__isError=!0,t.message=t.message||e.message,t.name=t.name||e.name),t}function u(n){if(!_)return(new e).reject(new Error("plugin not connected"));n.id=String(p++);var r=new e;y[n.id]=r,r.then(null,function(e){d&&e instanceof Error&&"Cancel"===e.name&&b({requestId:n.id,method:"cancel",params:e.message?[e.message]:[]})});var o=Object.prototype.toString;return n.params.forEach(function(e,i){if("[object Object]"===o.call(e)&&!(e instanceof t)){var s,u;for(s in e)"[object Function]"===o.call(e[s])&&(u=u||[],u.push(s));if(u){var a=h++;g[a]=e;var c=function(){delete g[a]};r.then(c,c),n.params[i]=new t(a,u)}}}),b(n),r.promise}function a(e,t){e||0===e?b({id:e,result:null,error:t}):console.log(t)}function c(e,t,n,r){r.forEach(function(e,t){if(e&&"undefined"!=typeof e.__objectId){var n={};e.__methods.forEach(function(t){n[t]=function(){return u({objectId:e.__objectId,method:t,params:Array.prototype.slice.call(arguments)})}}),r[t]=n}});var o="undefined"==typeof e?null:{id:e,result:null,error:null};try{var i=n.apply(t,r);if(!o)return;i&&"function"==typeof i.then?(m[e]=i,i.then(function(t){delete m[e],o.result=t,b(o)},function(t){m[e]&&(delete m[e],o.error=s(t),b(o))},function(){b({responseId:e,method:"progress",params:Array.prototype.slice.call(arguments)})})):(o.result=i,b(o))}catch(a){o&&(o.error=s(a),b(o))}}function f(e){if(e.source===_||"undefined"==typeof window){var t="string"!=typeof e.data?e.data:JSON.parse(e.data);try{if(t.method){var n=t.method,r=t.params||[];if("serviceId"in t){var o=w[t.serviceId];o||a(t.id,"service not found"),o=o.implementation,n in o?c(t.id,o,o[n],r):a(t.id,"method not found")}else if("objectId"in t){var i=g[t.objectId];i||a(t.id,"object not found"),!n in i?c(t.id,i,i[n],r):a(t.id,"method not found")}else if("requestId"in t){var s=m[t.requestId];s&&"cancel"===n&&s.cancel&&s.cancel.apply(s,r)}else{if(!("responseId"in t))throw new Error("Bad method: "+t.method);var u=y[t.responseId];u&&"progress"===n&&u.progress&&u.progress.apply(u,r)}}else{var f=y[String(t.id)];delete y[String(t.id)],t.error?f.reject(t.error):f.resolve(t.result)}}catch(l){console.log("Plugin._messageHandler "+l)}}}var l=n,d=!1,p=0,h=0,v=0,m={},y={},g={},w={},_=null;"undefined"==typeof window?_=self:window!==window.parent?_=window.parent:null!==window.opener&&(_=window.opener);var b=r;r({method:"loading"}),this.updateHeaders=function(e){if(d)throw new Error("Cannot update headers. Plugin Provider is connected");l=e},this.registerService=function(e,t,n){if(d)throw new Error("Cannot register service. Plugin Provider is connected");"string"==typeof e?e=[e]:Array.isArray(e)||(e=[]);var r=null,o=[];for(r in t)"function"==typeof t[r]&&o.push(r);w[v++]={names:e,methods:o,implementation:t,properties:n||{},listeners:{}}},this.registerServiceProvider=this.registerService,this.connect=function(e,t){if(d)return void(e&&e());if(!_)return void(t&&t("No valid plugin target"));addEventListener("message",f,!1);var n={method:"plugin",params:[o()]};r(n),d=!0,e&&e()},this.disconnect=function(){d&&(removeEventListener("message",f),_=null,d=!1)}}return n}),define("orion/xsrfUtils",[],function(){function e(){var e,t,n,o=document.cookie.split(";");for(e=0;e<o.length;e++)if(t=o[e].substr(0,o[e].indexOf("=")).trim(),n=o[e].substr(o[e].indexOf("=")+1).trim(),t==r)return n}function t(t){var n=e();n&&(t[r]=n)}function n(t){var n=e();n&&t.setRequestHeader(r,n)}var r="x-csrf-token";return{XSRF_TOKEN:r,getCSRFToken:e,setNonceHeader:t,addCSRFNonce:n}}),function(){function e(e){if("string"!=typeof e)throw new TypeError}function t(e){return e?e.split("&"):[]}function n(e){return 0===e.length?"":e.join("&")}function r(e){var t=/([^=]*)(?:=?)(.*)/.exec(e),n=t[1]?decodeURIComponent(t[1]):"",r=t[2]?decodeURIComponent(t[2]):"";return[n,r]}function o(e){var t=encodeURIComponent(e[0]);return e[1]&&(t+="="+encodeURIComponent(e[1])),t}function i(e,n){var o="",i=[],s=0;return{next:function(){if(o!==e.query&&(o=e.query,i=t(o)),s<i.length){var u=r(i[s++]);switch(n){case"keys":return u[0];case"values":return u[1];case"keys+values":return[u[0],u[1]];default:throw new TypeError}}throw O}}}function s(e){Object.defineProperty(this,"_url",{get:function(){return e._url}})}function u(e,t){if(!e.scheme&&t&&(e.scheme=t.scheme,!e.host&&t.host&&(e.userinfo=t.userinfo,e.host=t.host,e.port=t.port,e.pathRelative=!0)),e.pathRelative)if(e.path){if("/"!==e.path[0]){var n=/^(.*\/)[^\/]*$/.exec(t.path)[1]||"/";e.path=n+e.path}}else e.path=t.path}function a(e){return e.toLowerCase()}function c(e){return e?/[1-9]\d*$/.exec(e)[0]:""}function f(e){var t=[];return e.split("/").forEach(function(e){".."===e?t.pop():"."!==e&&t.push(e)}),t.join("/")}function l(e){e.scheme&&(e.scheme=a(e.scheme)),e.port&&(e.port=c(e.port)),e.host&&e.path&&(e.path=f(e.path))}function d(e){return e.replace(/\s/g,function(e){return"%"+e.charCodeAt(0).toString(16)})}function p(e,t){if("string"!=typeof e)throw new TypeError;e=d(e);var n=g.exec(e);if(!n)return null;var r={};if(r.scheme=n[1]||"",r.scheme&&!b.test(r.scheme))return null;var o=n[2];if(o){var i=w.exec(o);if(r.userinfo=i[1],r.host=i[2],r.port=i[3],r.port&&!E.test(r.port))return null}return r.path=n[3],r.query=n[4],r.fragment=n[5],u(r,t),l(r),r}function h(e){var t=e.scheme?e.scheme+":":"";return e.host&&(t+="//",e.userinfo&&(t+=e.userinfo+"@"),t+=e.host,e.port&&(t+=":"+e.port)),t+=e.path,e.query&&(t+="?"+e.query),e.fragment&&(t+="#"+e.fragment),t}function v(e,t){var n;if(t){if(t=t.href||t,n=p(t),!n||!n.scheme)throw new SyntaxError;Object.defineProperty(this,"_baseURL",{value:n})}var r=p(e,n);if(!r)throw new SyntaxError;Object.defineProperty(this,"_input",{value:e,writable:!0}),Object.defineProperty(this,"_url",{value:r,writable:!0});var o=new s(this);Object.defineProperty(this,"query",{get:function(){return this._url?o:null},enumerable:!0})}try{var m;if("function"==typeof window.URL&&0!==window.URL.length&&"http:"===(m=new window.URL("http://www.w3.org?q")).protocol&&m.query)return}catch(y){}var g=/^(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?$/,w=/^(?:(.*)@)?(\[[^\]]*\]|[^:]*)(?::(.*))?$/,_=/^\S*$/,b=/^([a-zA-Z](?:[a-zA-Z0-9+-.])*)$/,E=/^\d*$/,j=/^(\[[^\]\/?#\s]*\]|[^:\/?#\s]*)$/,U=/^(\[[^\]\/?#\s]*\]|[^:\/?#\s]*)(?::(\d*))?$/,x=/^([^?#\s]*)$/,P=/^([^\s]*)$/,L=_,T=/([^:]*):?(.*)/,O="undefined"!=typeof StopIteration?StopIteration:new Error("Stop Iteration"),R={"ftp:":"21","gopher:":"70","http:":"80","https:":"443","ws:":"80","wss:":"443"};Object.defineProperties(s.prototype,{get:{value:function(n){e(n);var o,i=t(this._url.query);return i.some(function(e){var t=r(e);return t[0]===n?(o=t[1],!0):void 0}),o},enumerable:!0},set:{value:function(i,s){e(i),e(s);var u=t(this._url.query),a=u.some(function(e,t){var n=r(e);return n[0]===i?(n[1]=s,u[t]=o(n),!0):void 0});a||u.push(o([i,s])),this._url.query=n(u)},enumerable:!0},has:{value:function(n){e(n);var o=t(this._url.query);return o.some(function(e){var t=r(e);return t[0]===n?!0:void 0})},enumerable:!0},"delete":{value:function(o){e(o);var i=t(this._url.query),s=i.filter(function(e){var t=r(e);return t[0]!==o});return s.length!==i.length?(this._url.query=n(s),!0):!1},enumerable:!0},clear:{value:function(){this._url.query=""},enumerable:!0},forEach:{value:function(e,t){if("function"!=typeof e)throw new TypeError;var n=i(this._url,"keys+values");try{for(;;){var r=n.next();e.call(t,r[1],r[0],this)}}catch(o){if(o!==O)throw o}},enumerable:!0},keys:{value:function(){return i(this._url,"keys")},enumerable:!0},values:{value:function(){return i(this._url,"values")},enumerable:!0},items:{value:function(){return i(this._url,"keys+values")}},size:{get:function(){return t(this._url.query).length},enumerable:!0},getAll:{value:function(n){e(n);var o=[],i=t(this._url.query);return i.forEach(function(e){var t=r(e);t[0]===n&&o.push(t[1])}),o},enumerable:!0},append:{value:function(r,i){e(r),e(i);var s=t(this._url.query);s.push(o([r,i])),this._url.query=n(s)},enumerable:!0}}),Object.defineProperties(v.prototype,{href:{get:function(){return this._url?h(this._url):this._input},set:function(t){e(t),this._input=t,this._url=p(this._input,this._baseURL)},enumerable:!0},origin:{get:function(){return this._url&&this._url.host?this.protocol+"//"+this.host:""},enumerable:!0},protocol:{get:function(){return this._url?this._url.scheme+":":":"},set:function(t){if(e(t),this._url){var n=":"===t.slice(-1)?t.substring(0,t.length-1):t;(""===n||b.test(n))&&(this._url.scheme=a(n))}},enumerable:!0},_userinfo:{get:function(){return this._url?this._url.userinfo:""},set:function(t){e(t),this._url&&(this._url.userinfo=t)}},username:{get:function(){if(!this._url)return"";var e=T.exec(this._userinfo),t=decodeURIComponent(e[1]||"");return t},set:function(t){if(e(t),this._url){var n=T.exec(this._userinfo),r=[encodeURIComponent(t||"")];n[2]&&r.push(n[2]),this._userinfo=r.join(":")}},enumerable:!0},password:{get:function(){if(!this._url)return"";var e=T.exec(this._userinfo),t=decodeURIComponent(e[2]||"");return t},set:function(t){if(e(t),this._url){var n=T.exec(this._userinfo),r=[n[1]||""];t&&r.push(encodeURIComponent(t)),this._userinfo=r.join(":")}},enumerable:!0},host:{get:function(){var e="";return this._url&&this._url.host&&(e+=this._url.host,this._url.port&&(e+=":"+this._url.port)),e},set:function(t){if(e(t),this._url){var n=U.exec(t);n&&(this._url.host=n[1],this._url.port=c(n[2]))}},enumerable:!0},hostname:{get:function(){return this._url?this._url.host:""},set:function(t){if(e(t),this._url){var n=j.exec(t);n&&(this._url.host=t)}},enumerable:!0},port:{get:function(){var e=this._url?this._url.port||"":"";return e&&e===R[this.protocol]&&(e=""),e},set:function(t){if(e(t),this._url){var n=E.exec(t);n&&(this._url.port=c(t))}},enumerable:!0},pathname:{get:function(){return this._url?this._url.path:""},set:function(t){if(e(t),this._url){var n=x.exec(t);n&&(this._url.host&&t&&"/"!==t[0]&&(t="/"+t),this._url.path=t?f(t):"")}},enumerable:!0},search:{get:function(){return this._url&&this._url.query?"?"+this._url.query:""},set:function(t){if(e(t),this._url){t&&"?"===t[0]&&(t=t.substring(1));var n=P.exec(t);n&&(this._url.query=t)}},enumerable:!0},hash:{get:function(){return this._url&&this._url.fragment?"#"+this._url.fragment:""},set:function(t){if(e(t),this._url){t&&"#"===t[0]&&(t=t.substring(1));var n=L.exec(t);n&&(this._url.fragment=t)}},enumerable:!0}});var C=window.URL||window.webkitURL;C&&C.createObjectURL&&(Object.defineProperty(v,"createObjectURL",{value:C.createObjectURL.bind(C),enumerable:!1}),Object.defineProperty(v,"revokeObjectURL",{value:C.revokeObjectURL.bind(C),enumerable:!1})),window.URL=v}(),define("orion/URL-shim",function(){}),define("orion/xhr",["orion/Deferred","orion/xsrfUtils","orion/URL-shim"],function(e,t){function n(e,t,n,r){var o,i="undefined"!=typeof n.response?n.response:n.responseText,s="string"==typeof i?i:null;try{o=n.status}catch(u){o=0}var a={args:t,response:i,responseText:s,status:o,url:e,xhr:n};return"undefined"!=typeof r&&(a.error=r),a}function r(e){return new URL(location.href).origin===new URL(e,location.href).origin}function o(o,i,s){s=s||{};var u=arguments.length>3&&arguments[3]?arguments[3]:new XMLHttpRequest,a=new e,c=s.headers||{};r(i)&&t.setNonceHeader(c);var f,l=s.log||!1;"undefined"==typeof c["X-Requested-With"]&&(c["X-Requested-With"]="XMLHttpRequest"),"undefined"==typeof s.data||"POST"!==o&&"PUT"!==o||(f=s.data);var d=!1,p=!1;a.promise.then(void 0,function(e){d=!0,!p&&e instanceof Error&&"Cancel"===e.name&&u.abort()}),u.onabort=function(){if(p=!0,!d){var e=new Error("Cancel");e.name="Cancel",a.reject(e)}},u.onload=function(){var e=n(i,s,u);200<=u.status&&u.status<400?a.resolve(e):(a.reject(e),l&&"undefined"!=typeof console&&console.log(new Error(u.statusText)))},u.onerror=function(){var e=n(i,s,u);a.reject(e),l&&"undefined"!=typeof console&&console.log(new Error(u.statusText))},u.onprogress=function(e){e.xhr=u,a.progress(e)};try{if(u.open(o,i,!0),"string"==typeof s.responseType&&(u.responseType=s.responseType),"number"==typeof s.timeout)if("number"==typeof u.timeout)u.timeout=s.timeout,u.addEventListener("timeout",function(){a.reject(n(i,s,u,"Timeout exceeded"))});else{var h=setTimeout(function(){a.reject(n(i,s,u,"Timeout exceeded"))},s.timeout);a.promise.then(clearTimeout.bind(null,h),clearTimeout.bind(null,h))}Object.keys(c).forEach(function(e){u.setRequestHeader(e,c[e])}),u.send(f||null)}catch(v){a.reject(n(i,s,u,v))}return a.promise}return o}),define("orion/EventTarget",[],function(){function e(){this._namedListeners={}}return e.prototype={dispatchEvent:function(e){if(!e.type)throw new Error("unspecified type");var t=this._namedListeners[e.type];return t&&t.forEach(function(t){try{"function"==typeof t?t(e):t.handleEvent(e)}catch(n){"undefined"!=typeof console&&console.log(n)}}),!e.defaultPrevented},addEventListener:function(e,t){("function"==typeof t||t.handleEvent)&&(this._namedListeners[e]=this._namedListeners[e]||[],this._namedListeners[e].push(t))},removeEventListener:function(e,t){var n=this._namedListeners[e];if(n)for(var r=0;r<n.length;r++)if(n[r]===t){1===n.length?delete this._namedListeners[e]:n.splice(r,1);break}}},e.prototype.constructor=e,e.attach=function(t){var n=new e;t.dispatchEvent=n.dispatchEvent.bind(n),t.addEventListener=n.addEventListener.bind(n),t.removeEventListener=n.removeEventListener.bind(n)},e}),define("orion/form",[],function(){function e(e){return encodeURIComponent(e).replace(/[!'()*]/g,escape).replace("%20","+")}return{encodeFormData:function(t){t=t||{};for(var n=Object.keys(t),r=[],o=0;o<n.length;o++){var i=n[o],s=t[i];r.push(e(i)+"="+e(s))}return r.join("&")},encodeSlug:function(e){return e.replace(/([^\u0020-\u007e]|%)+/g,encodeURIComponent)}}}),define("profile/UsersService",["orion/Deferred","orion/xhr","orion/EventTarget","orion/form"],function(e,t,n){function r(e){return""===e?null:JSON.parse(e)}function o(e){n.attach(this),e&&(this._serviceRegistry=e,this._serviceRegistration=e.registerService("orion.core.user",this))}return o.prototype={getUsersListSubset:function(n,o,i){var s=new e,u=this,a="../users?start="+n+"&rows="+o;return t("GET",a,{headers:{"Orion-Version":"1"},timeout:15e3}).then(function(e){var t=r(e.response);i&&("function"==typeof i?i(t):u.dispatchEvent({type:i,data:t})),s.resolve(t)},function(e){s.reject(e.response||e)}),s},getUsersList:function(n){var o=new e,i=this;return t("GET","../users",{headers:{"Orion-Version":"1"},timeout:15e3}).then(function(e){var t=r(e.response);n&&("function"==typeof n?n(t):i.dispatchEvent({type:n,data:t})),o.resolve(t.Users)},function(e){o.reject(e.response||e)}),o},deleteUser:function(n,o){var i=new e,s=this;return t("DELETE",n,{headers:{"Orion-Version":"1"},timeout:15e3}).then(function(e){var t=r(e.response);o&&("function"==typeof o?o(t):s.dispatchEvent({type:o,data:t})),i.resolve(t)},function(e){var t=e;try{t=r(e.response||e.error)}catch(n){}i.reject(t)}),i},createUser:function(n){n=n||{};var o={UserName:n.UserName,Password:n.Password,Email:n.Email};return t("POST","../users",{headers:{"Content-Type":"application/json","Orion-Version":"1"},timeout:15e3,data:JSON.stringify(o)}).then(function(t){return(new e).resolve(r(t.response))},function(t){var n=t;try{n=r(t.response||t.error)}catch(o){}return(new e).reject(n)})},getUserInfo:function(n,o){var i=new e,s=this;return t("GET",n,{headers:{"Orion-Version":"1"},timeout:15e3}).then(function(e){var t=r(e.response);o&&("function"==typeof o?o(t):s.dispatchEvent({type:o,data:t})),i.resolve(t)},function(e){i.reject(e.response||e)}),i},updateUserInfo:function(n,o,i){var s=new e,u=this,a=n;return o.Password!==o.passwordRetype?(s.reject({message:"Passwords do not match!"}),s):(t("PUT",a,{headers:{"Content-Type":"application/json; charset=UTF-8","Orion-Version":"1"},timeout:15e3,data:JSON.stringify(o)}).then(function(e){var t=r(e.response);i&&("function"==typeof i?i(t):u.dispatchEvent({type:i,data:t})),s.resolve(t)},function(e){if(409===e.status){var t=r(e.response),n=t.Message;alert(n)}s.reject(e.response||e)}),s)},resetUserPassword:function(n,o,i){var s=this,u={Password:o,Reset:!0};return t("POST","../users/"+n,{headers:{"Content-Type":"application/json; charset=UTF-8","Orion-Version":"1"},timeout:15e3,data:JSON.stringify(u)}).then(function(t){var n=r(t.response);return i&&("function"==typeof i?i(n):s.dispatchEvent({type:i,data:n})),(new e).resolve(n)},function(t){var n=t;try{n=r(t.response||t.error)}catch(o){}return(new e).reject(n)})}},o}),define("domReady",[],function(){function e(e){var t;for(t=0;t<e.length;t+=1)e[t](c)}function t(){var t=f;a&&t.length&&(f=[],e(t))}function n(){a||(a=!0,s&&clearInterval(s),t())}function r(e){return a?e(c):f.push(e),r}var o,i,s,u="undefined"!=typeof window&&window.document,a=!u,c=u?document:null,f=[];if(u){if(document.addEventListener)document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1);else if(window.attachEvent){window.attachEvent("onload",n),i=document.createElement("div");try{o=null===window.frameElement}catch(l){}i.doScroll&&o&&window.external&&(s=setInterval(function(){try{i.doScroll(),n()}catch(e){}},30))}"complete"===document.readyState&&n()}return r.version="2.0.1",r.load=function(e,t,n,o){o.isBuild?n(null):r(n)},r}),define("profile/userservicePlugin",["orion/plugin","profile/UsersService","domReady!"],function(e,t){var n=new t,r=document.createElement("a");r.href="../mixloginstatic/LoginWindow.html";var o=r.href,i={name:"Orion User Profile",version:"1.0",description:"This plugin supports access and modification of a user's profile information.",login:o},s=new e(i);n.info=function(){return{name:"User profile"}},n.getDivContent=function(){var e={actions:[{id:"saveProfileButton",name:"Save Profile",tooltip:"Save Profile",action:"saveProfile"},{id:"resetProfileButton",name:"Reset",tooltip:"Reset Profile Information",action:"resetProfile"},{id:"deleteProfileButton",name:"Delete Profile",tooltip:"Delete Profile",action:"deleteProfile"}],sections:[{id:"personalInformation",name:"Personal Information",data:[{type:"TextBox",props:{id:"pi_username",readOnly:!1,name:"UserName"},label:"User Name:"},{type:"TextBox",props:{id:"pi_fullname",readOnly:!1,name:"FullName"},label:"Full Name:"},{type:"TextBox",props:{id:"pi_email",readOnly:!1,name:"Email"},label:"Email:"},{type:"CheckBox",props:{id:"pi_emailConfirmed",readOnly:!0,name:"EmailConfirmed"},label:"Email confirmed:"},{type:"DateLong",props:{id:"pi_lastLogin",name:"LastLoginTimestamp"},label:"Last login:	"},{type:"Text",props:{id:"pi_diskUsage",name:"DiskUsage"},label:"Disk Usage:	"},{type:"DateLong",props:{id:"pi_diskUsageTimestamp",name:"DiskUsageTimestamp"},label:"Disk Usage Last Calculated:	"}]},{id:"oauthids",name:"Manage External Accounts",type:"iframe",data:{src:"../mixloginstatic/manageExternalIds.html"}}]};return e},n.initProfile=function(e,t,r){return this.getUserInfo(e,function(e){n.dispatchEvent({type:t,data:e}),n.dispatchEvent({type:r,data:e})})},n.fire=function(e,t,n){switch(e){case"saveProfile":return this.updateUserInfo(t,n,function(e,t){return this.initProfile(e,"requiredPluginsChanged","userInfoChanged"),t&&t.Message?t:{Message:"Profile saved!",status:200}}.bind(this,t));case"resetProfile":return this.getUserInfo(t,"userInfoChanged");case"deleteProfile":var r=n.login?n.login:t;if(confirm("Do you really want to delete user "+r+"?"))return this.deleteUser(t,"userDeleted");break;default:return this.updateUserInfo(t,n,function(e,t){return this.initProfile(e,"requiredPluginsChanged","userInfoChanged"),t&&t.Message?t:{Message:"Profile saved!",status:200}}.bind(this,t))}},s.registerService("orion.core.user",n),s.connect()});